{"dataflow":{"dfKey":"81800c67-aef2-484f-a8d8-48653816c1d6","name":"Dataflow_1043","tags":null,"description":null,"definition":"{\"name\":\"Dataflow_1043\",\"version\":0,\"livyServerId\":0,\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"import re\\r\\nimport databricks.koalas as ks\\r\\nimport json\\r\\nimport os\\r\\nconn_map\\u003dspark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.getConnectionParams(\\\"EXCEL_local_plugin\\\",\\\"read\\\")\\r\\nconn\\u003d[conn_map.toList().apply(i) for i in range(conn_map.size())]\\r\\nconn_details\\u003d {i._1(): i._2() for i in conn}\\r\\npath\\u003dconn_details[\\\"path\\\"]\\r\\nfilepath\\u003dos.path.join(path,\\\"Film_actor.xlsx\\\")\\r\\nheader \\u003d 0 if conn_details.get(\\\"useHeader\\\")\\u003d\\u003d\\\"true\\\" else None\\r\\n\\r\\nsheet_names \\u003d [\\\"Sheet1\\\",\\\"Sheet4\\\"]\\r\\nif sheet_names is None or type(sheet_names) \\u003d\\u003d list:\\r\\n\\tif type(sheet_names) \\u003d\\u003d list:\\r\\n\\t\\tif len(sheet_names)\\u003d\\u003d0:\\r\\n\\t\\t\\traise Exception(\\\"sheet names should not be empty list\\\")\\r\\nelse:\\r\\n\\traise Exception(\\\"sheet names should be list or None\\\")\\r\\n\\r\\ndf1 \\u003d ks.read_excel(filepath,engine\\u003d\\\"openpyxl\\\",sheet_name\\u003dsheet_names,dtype\\u003dstr,header\\u003d0)\\r\\nls\\u003d[]\\r\\nfor i in df1.keys():\\r\\n\\tk\\u003dre.sub(\\\"[^0-9A-Za-z_]\\\", \\\"_\\\", i)\\r\\n\\tprint(k)\\r\\n\\tdf1[i].columns\\u003ddf1[i].columns.astype(str).str.replace(\\\"[^0-9A-Za-z_]\\\",\\\"_\\\")\\r\\n\\tdf1[i]\\u003ddf1[i].fillna(\\\"\\\")\\r\\n\\tdf1[i]\\u003ddf1[i].to_spark()\\r\\n\\tdf1[i].show(5)\\r\\n\\tspark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.saveDataset(df1[i]._jdf,k,\\\"Code 1\\\",22363)\\r\\n\\tls.append(k)\\r\\n\\tdf1[i].createOrReplaceTempView(k)\\r\\n\\t\\r\\nspark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.deleteDatasetInfo(json.dumps(ls),22363,\\\"Code 1\\\")\\t\\r\\n\\t\\r\\n\\t\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":1,\"componentName\":\"Code 1\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":2,\"componentName\":\"JDBC 2\",\"tableName\":\"JDBC_2\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"MySQL8\",\"displayRows\":50,\"dependencies\":[1],\"options\":{\"dbTable\":\"select actor_id from sakila.act\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":2,"livyOptions":"{\"kind\":\"spark\",\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":0,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":\"\",\"conf\":{},\"heartbeatTimeoutInSecond\":0}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}