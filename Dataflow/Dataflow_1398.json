{"dataflow":{"dfKey":"d53752ba-dba4-4f72-a940-68046612d7f4","name":"Dataflow_1398","tags":null,"description":null,"definition":"{\"name\":\"Dataflow_1398\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"pluginId\":\"a9670244-0a57-419a-8770-ec28cde95f7d\",\"pluginName\":\"Create a Jira Ticket\",\"pluginOptions\":{\"parameters\":[{\"parameterId\":\"c2744657-b7f4-4887-a115-ec011d2f94db\",\"fieldName\":\"project\",\"displayName\":\"Project Key\",\"value\":\"DS\",\"dataType\":\"String\"},{\"parameterId\":\"0b7a9f89-dc74-4a5d-a9a6-775010d42d6d\",\"fieldName\":\"issuetype\",\"displayName\":\"Issue Type\",\"value\":\"Bug\",\"dataType\":\"Choice\"},{\"parameterId\":\"e7c713c8-418c-4f1e-83de-0e99239dcb1f\",\"fieldName\":\"summary\",\"displayName\":\"Summary\",\"value\":\"Sample Test data\",\"dataType\":\"String\"},{\"parameterId\":\"162a3cbd-0711-4588-8c7b-ce5910b237ea\",\"fieldName\":\"description\",\"displayName\":\"Description (Optional)\",\"value\":\"\\\" \\\"\",\"dataType\":\"text\"},{\"parameterId\":\"2db3dab5-41ad-481b-a771-aa01b9d8abf5\",\"fieldName\":\"Priority\",\"displayName\":\"Priority\",\"value\":\"Default\",\"dataType\":\"Choice\"}],\"inputDatasets\":[],\"outputDatasets\":[],\"dataSources\":[]},\"componentId\":1,\"componentName\":\"Plugin 1\",\"tableName\":\"Plugin_1\",\"category\":\"Processor\",\"componentType\":\"Plugin\",\"rank\":0,\"displayRows\":0,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.PluginComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"import requests\\r\\nimport json\\r\\nimport io\\r\\nimport base64\\r\\nimport re\\r\\nimport psycopg2\\r\\nfrom datagaps_utilities.config import properties_file_path\\r\\nfrom jproperties import Properties\\r\\n\\r\\nhost \\u003d port \\u003d database \\u003d username \\u003d password \\u003d \\\"\\\"\\r\\nconfigs \\u003d Properties()\\r\\nwith open(properties_file_path, \\\"rb\\\") as config_file:\\r\\n\\tconfigs.load(config_file)\\r\\n\\tprint(configs[\\\"datasource.jdbcUrl\\\"])\\r\\n\\thost, port, database \\u003d re.match(\\\"jdbc:postgresql://(.*?):(.*?)/(.*)\\\", configs[\\\"datasource.jdbcUrl\\\"].data).groups()\\r\\n\\tdatabase \\u003d database.split(\\\"?\\\")[0]\\r\\n\\tusername \\u003d configs[\\\"datasource.userName\\\"].data\\r\\n\\tpassword \\u003d spark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.getDecryptedPassword(configs[\\\"datasource.password\\\"].data)\\r\\n\\tprint(password)\\r\\n\\twith psycopg2.connect(\\r\\n\\t\\tdatabase\\u003ddatabase,\\r\\n\\t\\tuser\\u003dusername,\\r\\n\\t\\tpassword\\u003dpassword,\\r\\n\\t\\thost\\u003dhost,\\r\\n\\t\\tport\\u003dport\\r\\n\\t) as con:\\r\\n\\t    with con.cursor() as cur:\\r\\n\\t        cur.execute(\\\"\\\"\\\"select url, COALESCE((select value from t_user_wallet  where user_id\\u003d(select updated_by from t_df_run where df_run_id\\u003d42216) and key\\u003d\\u0027jira_username\\u0027),username) as username, COALESCE((select value from t_user_wallet  where user_id\\u003d(select updated_by from t_df_run where df_run_id\\u003d42216) and key\\u003d\\u0027jira_token\\u0027),password) as password from t_server where type\\u003d\\u0027jira\\u0027 and container_id\\u003d81\\\"\\\"\\\")\\r\\n\\t        jira_cred_result \\u003d cur.fetchall()\\r\\n\\t        if(len(jira_cred_result)\\u003e0):\\r\\n\\t            jira_base_url \\u003d jira_cred_result[0][0]\\r\\n\\t            jira_username \\u003d jira_cred_result[0][1]\\r\\n\\t            jira_password \\u003d spark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.getDecryptedPassword(jira_cred_result[0][2])\\r\\n\\t            print(jira_username)\\r\\n\\t            print(jira_password)\\r\\n\\r\\n\\t\\t\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":2,\"componentName\":\"Code 2\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":2,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}