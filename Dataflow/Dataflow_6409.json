{"dataflow":{"dfKey":"7e5356ee-9eeb-4295-a688-ed76eb45fc7d","name":"Dataflow_6409","tags":null,"description":null,"definition":"{\"name\":\"Dataflow_6409\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":1,\"componentName\":\"JDBC 1\",\"tableName\":\"JDBC_1\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"MySQL8\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select actor_id,first_name,last_name,last_update from sakila.actor\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"sourceDataFrame\":\"JDBC_1\",\"targetDataFrame\":\"JDBC_1\",\"mapping\":[{\"sourceColumn\":\"actor_id\",\"sourceType\":\"integer\",\"targetColumn\":\"actor_id\",\"targetType\":\"integer\",\"unique\":\"Y\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"integer\",\"orginalTargetType\":\"integer\"},{\"sourceColumn\":\"first_name\",\"sourceType\":\"string\",\"targetColumn\":\"first_name\",\"targetType\":\"string\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"string\",\"orginalTargetType\":\"string\"},{\"sourceColumn\":\"last_name\",\"sourceType\":\"string\",\"targetColumn\":\"last_name\",\"targetType\":\"string\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"string\",\"orginalTargetType\":\"string\"},{\"sourceColumn\":\"last_update\",\"sourceType\":\"date\",\"targetColumn\":\"last_update\",\"targetType\":\"date\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"date\",\"orginalTargetType\":\"date\"}],\"onlyInA\":\"Y\",\"onlyInB\":\"Y\",\"difference\":\"Y\",\"enableTrim\":\"N\",\"replaceNull\":\"N\",\"autoDataTypeConversion\":\"N\",\"columnDifferencesCount\":\"N\",\"ignoreCase\":\"N\",\"hasDuplicates\":\"N\",\"subDataFrames\":[{\"subDataFrameName\":\"_Source_Duplicate\",\"type\":\"Duplicates In A\"},{\"subDataFrameName\":\"_Target_Duplicate\",\"type\":\"Duplicates In B\"},{\"subDataFrameName\":\"_Matched\",\"type\":\"Matched\"},{\"subDataFrameName\":\"_OnlySource\",\"type\":\"Only In A\"},{\"subDataFrameName\":\"_OnlyTarget\",\"type\":\"Only In B\"},{\"subDataFrameName\":\"_Difference\",\"type\":\"Difference\"}],\"onlyInAThresholdUnit\":\"number\",\"onlyInAThreshold\":0.0,\"onlyInBThresholdUnit\":\"number\",\"onlyInBThreshold\":0.0,\"differencesSourceThresholdUnit\":\"number\",\"differencesSourceThreshold\":0.0,\"differencesTargetThresholdUnit\":\"number\",\"differencesTargetThreshold\":0.0,\"componentId\":2,\"componentName\":\"Data Compare 2\",\"tableName\":\"Data_Compare_2\",\"category\":\"Data Quality\",\"componentType\":\"Data Compare\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[1],\"options\":{},\"className\":\"com.datagaps.dataflow.models.DataCompareComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"import org.apache.commons.lang3.StringUtils\\nimport java.io.StringWriter\\nval ds \\u003d spark.sql(\\\"select * from jdbc_1\\\")\\n//val catalyst_plan2: String \\u003d ds.explain(mode \\u003d \\\"cost\\\")\\n//print(ds.limit(1).toJSON.collectAsList().toString)\\n//val catalyst_plan2 \\u003d ds.explain(\\\"cost\\\").toString\\n/*var str \\u003d StringUtils.substringBetween(ds.limit(1).toJSON.collectAsList().toString,\\\"sizeInBytes\\u003d\\\",\\\",\\\")\\n\\n//print(str)\\nstr \\u003d str.replaceAll(\\\"[^\\\\\\\\d.]\\\", \\\"\\\")\\n//if(StringUtils.contains(str,\\\"KiB\\\")){\\n        //str \\u003d StringUtils.removeEnd(str,\\\"KiB\\\")\\n        var num \\u003d str.toDouble\\n        println(num)\\n      }*/\\n      \\n      val stringWriter \\u003d new StringWriter()\\n\\n// Explain the execution plan with cost and redirect the output to the StringWriter\\nspark.sparkContext.setLogLevel(\\\"TRACE\\\")  // Set log level to capture DEBUG output\\nConsole.withOut(stringWriter) {\\n  ds.explain(mode \\u003d \\\"cost\\\")\\n}\\n\\n// Get the explanation from the StringWriter\\nval explainedPlan: String \\u003d stringWriter.toString\\n\\n// Print or use the explained plan as needed\\nprintln(explainedPlan)\\n      \\n      //print(catalyst_plan2)\",\"kind\":\"spark\",\"dataSourceId\":0,\"componentId\":3,\"componentName\":\"Code 3_jdbc\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[1],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"val ds \\u003d spark.sql(\\\"EXPLAIN Cost select * from (select *,Row_number() OVER ( PARTITION BY actor_id  ORDER BY actor_id,first_name,last_name,last_update ) AS src_seq from Data_Compare_2_Source_Hash AS SRC  FULL OUTER JOIN (SELECT * ,Row_Number() OVER ( PARTITION BY actor_id_tgt ORDER BY actor_id_tgt,first_name_tgt,last_name_tgt,last_update_tgt) AS tgt_seq from Data_Compare_2_Target_Hash) AS TGT ON nvl(actor_id,\\u0027null\\u0027)  \\u003d nvl(actor_id_tgt,\\u0027null\\u0027) and src_seq\\u003d tgt_seq)\\\")\\nprint(ds.limit(1).toJSON.collectAsList().toString) \",\"kind\":\"spark\",\"dataSourceId\":0,\"componentId\":4,\"componentName\":\"Code 4\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[2],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":4,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}