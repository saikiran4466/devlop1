{"dataflow":{"dfKey":"10539481-2c4a-4bf2-8faf-c4de97f94674","name":"parquet_test_284","tags":null,"description":null,"definition":"{\"name\":\"parquet_test_284\",\"version\":0,\"livyServerId\":0,\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"excludeNotification\":\"N\"},{\"code\":\"val dataSet \\u003d spark.read.format(\\\"parquet\\\").load(\\\"/home/datagaps/Customers_space.parquet\\\")\\nvar numregex \\u003d \\\"[0-9]+\\\"\\n    val mulusRegex \\u003d \\\"(?i)([_])\\\\\\\\1{1,}\\\"\\nvar columnNames\\u003ddataSet.columns.map(col\\u003d\\u003ecol.replaceAll(\\\"[^a-zA-Z0-9_%#]+\\\", \\\"_\\\").replaceAll(mulusRegex,\\\"_\\\"))\\n    columnNames.foreach(col \\u003d\\u003e{\\n      if(col.matches(numregex)){\\n        columnNames \\u003d columnNames.map(col\\u003d\\u003ecol.replaceAll(numregex,\\\"col_\\\"+col))\\n      }\\n    })\\nvar renamedDF \\u003d dataSet.toDF(columnNames:_*)\\nrenamedDF.persist()\\nrenamedDF.show()\\n\\n\\n\",\"kind\":\"spark\",\"dataSourceId\":0,\"componentId\":1,\"componentName\":\"Code 1\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"componentId\":2,\"componentName\":\"JDBC 2\",\"tableName\":\"JDBC_2\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Oracle1\",\"displayRows\":50,\"dependencies\":[1],\"options\":{\"dbTable\":\"select ACTOR_ID,FIRST_NAME,LAST_NAME,LAST_UPDATE from SH.ACTOR221\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":2,"livyOptions":"{\"kind\":\"spark\",\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":0,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":\"\",\"conf\":{},\"heartbeatTimeoutInSecond\":0}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":null,"folderPath":"Dataflow/siva","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}