{"dataflow":{"dfKey":"3f048c0c-c88b-4a22-8267-3388e8cef47d","name":"Dataflow_code_duplicates","tags":null,"description":"","definition":"{\"name\":\"Dataflow_code_duplicates\",\"description\":\"\",\"version\":0,\"livyServerId\":0,\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"excludeNotification\":\"N\"},{\"code\":\"import re\\r\\nimport smbclient\\r\\nimport databricks.koalas as ks\\r\\nsmbclient.ClientConfig(username\\u003d\\\"test5\\\", password\\u003d\\\"test5@123\\\")\\r\\n#//192.168.6.71/test5/ramesh/Sample_excel.xlsx\\r\\nwith smbclient.open_file(r\\\"//192.168.6.71/test5/ramesh/Sample_excel.xlsx\\\",mode\\u003d\\\"rb\\\") as fd:\\r\\n    df1 \\u003d ks.read_excel(fd,engine\\u003d\\\"openpyxl\\\",sheet_name\\u003dNone,dtype\\u003dstr)\\r\\n    for i in df1.keys():\\r\\n        k\\u003dre.sub(\\\"[-,$@\\u0026|.: ]\\\", \\\"_\\\", i)\\r\\n        print(k)\\r\\n        df1[i].columns\\u003ddf1[i].columns.str.replace(\\\"[@,|,.,%]\\\",\\\"_\\\")\\r\\n        df1[i]\\u003ddf1[i].fillna(\\\"\\\")\\r\\n        df1[i]\\u003ddf1[i].to_spark()\\r\\n       # spark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.saveDataset(df1[i]._jdf,k,\\\"Code 1\\\",$[dataflow_run_id])\\r\\n        df1[i].show(5)\\r\\n        #ls.append(k)\\r\\n        df1[i].createOrReplaceTempView(k)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":1,\"componentName\":\"Code 1\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":2,\"componentName\":\"SQL 2\",\"tableName\":\"SQL_2\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[1],\"options\":{\"dbTable\":\"select * from Sheet1\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"code\":\"import re\\r\\nimport smbclient\\r\\nimport databricks.koalas as ks\\r\\nsmbclient.ClientConfig(username\\u003d\\\"test5\\\", password\\u003d\\\"test5@123\\\")\\r\\n#//192.168.6.71/test5/ramesh/Sample_excel.xlsx\\r\\nwith smbclient.open_file(r\\\"//192.168.6.71/test5/ramesh/Sample_excel.xlsx\\\",mode\\u003d\\\"rb\\\") as fd:\\r\\n    df1 \\u003d ks.read_excel(fd,engine\\u003d\\\"openpyxl\\\",sheet_name\\u003dNone,dtype\\u003dstr)\\r\\n    for i in df1.keys():\\r\\n        k\\u003dre.sub(\\\"[-,$@\\u0026|.: ]\\\", \\\"_\\\", i)\\r\\n        print(k)\\r\\n        df1[i].columns\\u003ddf1[i].columns.str.replace(\\\"[@,|,.,%]\\\",\\\"_\\\")\\r\\n        df1[i]\\u003ddf1[i].fillna(\\\"\\\")\\r\\n        df1[i]\\u003ddf1[i].to_spark()\\r\\n        spark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.saveDataset(df1[i]._jdf,k,\\\"Code 3\\\",$[dataflow_run_id])\\r\\n        df1[i].show(5)\\r\\n        #ls.append(k)\\r\\n        df1[i].createOrReplaceTempView(k)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":3,\"componentName\":\"Code 3\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[2],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":4,\"componentName\":\"SQL 4\",\"tableName\":\"SQL_4\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[3],\"options\":{\"dbTable\":\"\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":5,\"componentName\":\"SQL 5\",\"tableName\":\"SQL_4\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[4],\"options\":{\"dbTable\":\"\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"code\":\"\\nfrom datagaps_utilities import dataset_to_rdb\\ndataset_to_rdb(session_object\\u003dspark,dataset_name\\u003d \\\"SQL_2\\\",primary_table_name\\u003d\\\"SQL_2\\\", use_short_names\\u003dFalse,component_name\\u003d\\\"Code 6\\\", dataflow_run_id\\u003d$[dataflow_run_id], dataflow_id\\u003d\\\"$[dataflow_id]\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":6,\"componentName\":\"Code 6\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[2],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":6,"livyOptions":"{\"kind\":\"spark\",\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"5G\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":2,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":\"\",\"conf\":{\"spark.hadoop.google.cloud.auth.service.account.json.keyfile\":\"/home/datagaps/data/datagapsQaBigquery.json\"},\"heartbeatTimeoutInSecond\":0}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}