{"dataflow":{"dfKey":"06ecc571-3d35-4fc4-a52b-4c744eb3b74e","name":"DFTest","tags":null,"description":null,"definition":"{\"name\":\"DFTest\",\"version\":0,\"livyServerId\":0,\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"componentId\":1,\"componentName\":\"Src\",\"tableName\":\"Src\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Oracle_102\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select CHANNEL_ID,CHANNEL_DESC,CHANNEL_CLASS,CHANNEL_CLASS_ID,CHANNEL_TOTAL,CHANNEL_TOTAL_ID from SH.CHANNELS\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"componentId\":2,\"componentName\":\"Tgt\",\"tableName\":\"Tgt\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Oracle_102\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select CHANNEL_ID,CHANNEL_DESC,CHANNEL_CLASS,CHANNEL_CLASS_ID-1 as CHANNEL_CLASS_ID,CHANNEL_TOTAL,CHANNEL_TOTAL_ID-1 as CHANNEL_TOTAL_ID  from SH.CHANNELS\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"sourceDataFrame\":\"Src\",\"targetDataFrame\":\"Tgt\",\"mapping\":[{\"sourceColumn\":\"CHANNEL_ID\",\"sourceType\":\"decimal(19,4)\",\"targetColumn\":\"CHANNEL_ID\",\"targetType\":\"decimal(19,4)\",\"unique\":\"Y\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\"},{\"sourceColumn\":\"CHANNEL_DESC\",\"sourceType\":\"string\",\"targetColumn\":\"CHANNEL_DESC\",\"targetType\":\"string\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\"},{\"sourceColumn\":\"CHANNEL_CLASS\",\"sourceType\":\"string\",\"targetColumn\":\"CHANNEL_CLASS\",\"targetType\":\"string\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\"},{\"sourceColumn\":\"CHANNEL_CLASS_ID\",\"sourceType\":\"decimal(19,4)\",\"targetColumn\":\"CHANNEL_CLASS_ID\",\"targetType\":\"decimal(19,4)\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\"},{\"sourceColumn\":\"CHANNEL_TOTAL\",\"sourceType\":\"string\",\"targetColumn\":\"CHANNEL_TOTAL\",\"targetType\":\"string\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\"},{\"sourceColumn\":\"CHANNEL_TOTAL_ID\",\"sourceType\":\"decimal(19,4)\",\"targetColumn\":\"CHANNEL_TOTAL_ID\",\"targetType\":\"decimal(19,4)\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\"}],\"onlyInA\":\"Y\",\"onlyInB\":\"Y\",\"difference\":\"Y\",\"enableTrim\":\"N\",\"replaceNull\":\"N\",\"autoDataTypeConversion\":\"N\",\"columnDifferencesCount\":\"Y\",\"ignoreCase\":\"N\",\"subDataFrames\":[{\"subDataFrameName\":\"_Source_Duplicate\",\"type\":\"Duplicates In A\"},{\"subDataFrameName\":\"_Target_Duplicate\",\"type\":\"Duplicates In B\"},{\"subDataFrameName\":\"_Matched\",\"type\":\"Matched\"},{\"subDataFrameName\":\"_OnlySource\",\"type\":\"Only In A\"},{\"subDataFrameName\":\"_OnlyTarget\",\"type\":\"Only In B\"},{\"subDataFrameName\":\"_Difference\",\"type\":\"Difference\"}],\"componentId\":3,\"componentName\":\"Data Compare\",\"tableName\":\"Data_Compare\",\"category\":\"Data Quality\",\"componentType\":\"Data Compare\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[2,1],\"options\":{},\"className\":\"com.datagaps.dataflow.models.DataCompareComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"componentId\":4,\"componentName\":\"SQL 4\",\"tableName\":\"SQL_4\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[3],\"options\":{\"dbTable\":\"Select (CASE WHEN nvl( CAST(CHANNEL_ID as String ) ,\\u0027null\\u0027) \\u003d nvl(CAST(CHANNEL_ID_tgt as String )  , \\u0027null\\u0027) THEN CAST(CHANNEL_ID as String) ELSE concat(\\u0027A : \\u0027,nvl( CAST(CHANNEL_ID as String ) , \\u0027null\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(CAST(CHANNEL_ID_tgt as String )  , \\u0027null\\u0027) ) END) as CHANNEL_ID ,(CASE WHEN nvl(CHANNEL_DESC,\\u0027null\\u0027) \\u003d nvl(CHANNEL_DESC_tgt , \\u0027null\\u0027) THEN CHANNEL_DESC ELSE concat(\\u0027A : \\u0027,nvl(CHANNEL_DESC, \\u0027null\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(CHANNEL_DESC_tgt , \\u0027null\\u0027) ) END) as CHANNEL_DESC ,(CASE WHEN nvl(CHANNEL_CLASS,\\u0027null\\u0027) \\u003d nvl(CHANNEL_CLASS_tgt , \\u0027null\\u0027) THEN CHANNEL_CLASS ELSE concat(\\u0027A : \\u0027,nvl(CHANNEL_CLASS, \\u0027null\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(CHANNEL_CLASS_tgt , \\u0027null\\u0027) ) END) as CHANNEL_CLASS ,(CASE WHEN nvl( CAST(CHANNEL_CLASS_ID as String ) ,\\u0027null\\u0027) \\u003d nvl(CAST(CHANNEL_CLASS_ID_tgt as String )  , \\u0027null\\u0027) THEN CAST(CHANNEL_CLASS_ID as String) ELSE concat(\\u0027A : \\u0027,nvl( CAST(CHANNEL_CLASS_ID as String ) , \\u0027null\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(CAST(CHANNEL_CLASS_ID_tgt as String )  , \\u0027null\\u0027) ) END) as CHANNEL_CLASS_ID ,(CASE WHEN nvl(CHANNEL_TOTAL,\\u0027null\\u0027) \\u003d nvl(CHANNEL_TOTAL_tgt , \\u0027null\\u0027) THEN CHANNEL_TOTAL ELSE concat(\\u0027A : \\u0027,nvl(CHANNEL_TOTAL, \\u0027null\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(CHANNEL_TOTAL_tgt , \\u0027null\\u0027) ) END) as CHANNEL_TOTAL ,(CASE WHEN nvl( CAST(CHANNEL_TOTAL_ID as String ) ,\\u0027null\\u0027) \\u003d nvl(CAST(CHANNEL_TOTAL_ID_tgt as String )  , \\u0027null\\u0027) THEN CAST(CHANNEL_TOTAL_ID as String) ELSE concat(\\u0027A : \\u0027,nvl( CAST(CHANNEL_TOTAL_ID as String ) , \\u0027null\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(CAST(CHANNEL_TOTAL_ID_tgt as String )  , \\u0027null\\u0027) ) END) as CHANNEL_TOTAL_ID  from Data_Compare where  nvl(hash_src,0) \\u003c\\u003e nvl(hash_tgt,0) and nvl(CHANNEL_ID,\\u0027null\\u0027)  \\u003d nvl(CHANNEL_ID_tgt,\\u0027null\\u0027)  \"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"code\":\"var df\\u003dspark.sql(\\\"select * from SQL_4\\\")\\r\\nval unPivotDF \\u003d df.select(\\r\\nexpr(\\\"stack(5, \\u0027channel_desc\\u0027, channel_desc, \\u0027channel_class\\u0027, channel_class, \\u0027channel_class_id\\u0027, channel_class_id,\\u0027channel_total\\u0027,channel_total,\\u0027channel_total_id\\u0027,channel_total_id) as (ColumnName,Differences)\\\")).where(\\\"Differences like \\u0027%A :%\\u0027 and Differences like \\u0027%B :%\\u0027\\\")\\r\\nunPivotDF.show()\",\"kind\":\"spark\",\"dataSourceId\":0,\"componentId\":7,\"componentName\":\"Code 7\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[4],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":7,"livyOptions":"{\"kind\":\"spark\",\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":0,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":\"\",\"conf\":{},\"heartbeatTimeoutInSecond\":0}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":null,"folderPath":"Dataflow","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}