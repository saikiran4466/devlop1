{"dataflow":{"dfKey":"fba69de7-4070-4c80-b81e-b8a3d989973d","name":"Dataflow_356_datacompare_issue","tags":null,"description":null,"definition":"{\"name\":\"Dataflow_356_datacompare_issue\",\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"\",\"excludeNotification\":\"Y\"},{\"format\":\"txt\",\"enableSchema\":\"N\",\"schema\":[],\"fileMetadata\":[],\"enableTrim\":\"N\",\"componentId\":1,\"componentName\":\"File 1\",\"tableName\":\"File_1\",\"category\":\"Source\",\"componentType\":\"File\",\"rank\":0,\"dataSourceName\":\"CSV_local_testfile_68\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"delimiter\":\",\",\"multiLine\":\"true\",\"header\":\"true\",\"inferSchema\":\"true\",\"path\":\"pwc1.txt\",\"Encoding\":\"\"},\"className\":\"com.datagaps.dataflow.models.FileComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"format\":\"txt\",\"enableSchema\":\"N\",\"schema\":[],\"fileMetadata\":[],\"enableTrim\":\"N\",\"componentId\":2,\"componentName\":\"File 2\",\"tableName\":\"File_2\",\"category\":\"Source\",\"componentType\":\"File\",\"rank\":0,\"dataSourceName\":\"CSV_local_testfile_68\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"delimiter\":\",\",\"multiLine\":\"true\",\"header\":\"true\",\"inferSchema\":\"true\",\"path\":\"pwc2.txt\",\"Encoding\":\"\"},\"className\":\"com.datagaps.dataflow.models.FileComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"sourceDataFrame\":\"File_1\",\"targetDataFrame\":\"File_2\",\"mapping\":[{\"sourceColumn\":\"uk\",\"sourceType\":\"integer\",\"targetColumn\":\"uk\",\"targetType\":\"integer\",\"unique\":\"Y\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"integer\",\"orginalTargetType\":\"integer\"},{\"sourceColumn\":\"co1\",\"sourceType\":\"double\",\"targetColumn\":\"co1\",\"targetType\":\"double\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"upperThreshold\":1.0,\"lowerThreshold\":-1.0,\"hasThreshold\":\"Y\",\"thresholdUnit\":\"percent\",\"originalSourceType\":\"double\",\"orginalTargetType\":\"double\"},{\"sourceColumn\":\"col3\",\"sourceType\":\"double\",\"targetColumn\":\"col3\",\"targetType\":\"double\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"upperThreshold\":1.0,\"lowerThreshold\":-1.0,\"hasThreshold\":\"Y\",\"thresholdUnit\":\"percent\",\"originalSourceType\":\"double\",\"orginalTargetType\":\"double\"}],\"onlyInA\":\"Y\",\"onlyInB\":\"Y\",\"difference\":\"Y\",\"enableTrim\":\"N\",\"replaceNull\":\"N\",\"autoDataTypeConversion\":\"N\",\"columnDifferencesCount\":\"N\",\"ignoreCase\":\"N\",\"hasDuplicates\":\"N\",\"subDataFrames\":[{\"subDataFrameName\":\"_Matched\",\"type\":\"Matched\"},{\"subDataFrameName\":\"_Source_Duplicate\",\"type\":\"Duplicates In A\"},{\"subDataFrameName\":\"_Target_Duplicate\",\"type\":\"Duplicates In B\"},{\"subDataFrameName\":\"_Difference\",\"type\":\"Difference\"},{\"subDataFrameName\":\"_OnlySource\",\"type\":\"Only In A\"},{\"subDataFrameName\":\"_OnlyTarget\",\"type\":\"Only In B\"}],\"onlyInAThresholdUnit\":\"number\",\"onlyInAThreshold\":0.0,\"onlyInBThresholdUnit\":\"number\",\"onlyInBThreshold\":0.0,\"differencesSourceThresholdUnit\":\"number\",\"differencesSourceThreshold\":0.0,\"differencesTargetThresholdUnit\":\"number\",\"differencesTargetThreshold\":0.0,\"componentId\":3,\"componentName\":\"Data Compare 3\",\"tableName\":\"Data_Compare_3\",\"category\":\"Data Quality\",\"componentType\":\"Data Compare\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[2,1],\"options\":{},\"className\":\"com.datagaps.dataflow.models.DataCompareComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"sourceDataFrame\":\"File_1\",\"targetDataFrame\":\"File_2\",\"mapping\":[{\"sourceColumn\":\"uk\",\"sourceType\":\"integer\",\"targetColumn\":\"uk\",\"targetType\":\"integer\",\"unique\":\"Y\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"integer\",\"orginalTargetType\":\"integer\"},{\"sourceColumn\":\"co1\",\"sourceType\":\"double\",\"targetColumn\":\"co1\",\"targetType\":\"double\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"upperThreshold\":1.0,\"lowerThreshold\":-1.0,\"hasThreshold\":\"Y\",\"thresholdUnit\":\"number\",\"originalSourceType\":\"double\",\"orginalTargetType\":\"double\"},{\"sourceColumn\":\"col2\",\"sourceType\":\"double\",\"targetColumn\":\"col2\",\"targetType\":\"double\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"upperThreshold\":1.0,\"lowerThreshold\":-1.0,\"hasThreshold\":\"Y\",\"thresholdUnit\":\"number\",\"originalSourceType\":\"double\",\"orginalTargetType\":\"double\"},{\"sourceColumn\":\"col3\",\"sourceType\":\"double\",\"targetColumn\":\"col3\",\"targetType\":\"double\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"upperThreshold\":1.0,\"lowerThreshold\":-1.0,\"hasThreshold\":\"Y\",\"thresholdUnit\":\"number\",\"originalSourceType\":\"double\",\"orginalTargetType\":\"double\"},{\"sourceColumn\":\"col4\",\"sourceType\":\"double\",\"targetColumn\":\"col4\",\"targetType\":\"double\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"upperThreshold\":1.0,\"lowerThreshold\":-1.0,\"hasThreshold\":\"Y\",\"thresholdUnit\":\"number\",\"originalSourceType\":\"double\",\"orginalTargetType\":\"double\"}],\"onlyInA\":\"Y\",\"onlyInB\":\"Y\",\"difference\":\"Y\",\"enableTrim\":\"N\",\"replaceNull\":\"N\",\"autoDataTypeConversion\":\"N\",\"columnDifferencesCount\":\"N\",\"ignoreCase\":\"N\",\"hasDuplicates\":\"N\",\"subDataFrames\":[{\"subDataFrameName\":\"_Matched\",\"type\":\"Matched\"},{\"subDataFrameName\":\"_Source_Duplicate\",\"type\":\"Duplicates In A\"},{\"subDataFrameName\":\"_Target_Duplicate\",\"type\":\"Duplicates In B\"},{\"subDataFrameName\":\"_Difference\",\"type\":\"Difference\"},{\"subDataFrameName\":\"_OnlySource\",\"type\":\"Only In A\"},{\"subDataFrameName\":\"_OnlyTarget\",\"type\":\"Only In B\"}],\"onlyInAThresholdUnit\":\"number\",\"onlyInAThreshold\":0.0,\"onlyInBThresholdUnit\":\"number\",\"onlyInBThreshold\":0.0,\"differencesSourceThresholdUnit\":\"number\",\"differencesSourceThreshold\":0.0,\"differencesTargetThresholdUnit\":\"number\",\"differencesTargetThreshold\":0.0,\"componentId\":4,\"componentName\":\"Data Compare 4\",\"tableName\":\"Data_Compare_4\",\"category\":\"Data Quality\",\"componentType\":\"Data Compare\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[1,2],\"options\":{},\"className\":\"com.datagaps.dataflow.models.DataCompareComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":5,\"componentName\":\"SQL 5\",\"tableName\":\"SQL_5\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[3],\"options\":{\"dbTable\":\"Select (CASE WHEN nvl(uk,\\u0027[null]\\u0027) \\u003d nvl(uk_tgt , \\u0027[null]\\u0027) THEN uk ELSE concat(\\u0027A : \\u0027,nvl(uk, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(uk_tgt , \\u0027[null]\\u0027) ) END) as uk ,(CASE WHEN nvl(co1,\\u0027[null]\\u0027) \\u003d nvl(co1_tgt , \\u0027[null]\\u0027) THEN co1 ELSE concat(\\u0027A : \\u0027,nvl(co1, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(co1_tgt , \\u0027[null]\\u0027) ,\\u0027\\r\\n\\u0027,\\u0027 V : \\u0027,(CASE WHEN co1_tgt is not null and co1 is not null THEN (CASE WHEN co1!\\u003d0 THEN round((co1_tgt -co1)*100/co1,5) ELSE \\u0027NA\\u0027 END) ELSE \\u0027NA\\u0027 END)) END) as co1 ,(CASE WHEN nvl(col3,\\u0027[null]\\u0027) \\u003d nvl(col3_tgt , \\u0027[null]\\u0027) THEN col3 ELSE concat(\\u0027A : \\u0027,nvl(col3, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(col3_tgt , \\u0027[null]\\u0027) ,\\u0027\\r\\n\\u0027,\\u0027 V : \\u0027,(CASE WHEN col3_tgt is not null and col3 is not null THEN (CASE WHEN col3!\\u003d0 THEN round((col3_tgt -col3)*100/col3,5) ELSE \\u0027NA\\u0027 END) ELSE \\u0027NA\\u0027 END)) END) as col3  from Data_Compare_3 where  nvl(hash_src,0) \\u003c\\u003e nvl(hash_tgt,0) and nvl(uk,\\u0027null\\u0027)  \\u003d nvl(uk_tgt,\\u0027null\\u0027)  and ((hash_tgt is not null and hash_src is not null))  or (((CASE WHEN co1_tgt is not null and co1 is not null THEN \\r\\n  (CASE WHEN co1!\\u003d0 THEN round((co1_tgt -co1)*100/co1,5) \\u003e -1 or round((co1_tgt -co1)*100/co1,5) \\u003c 1  ELSE \\u0027NA\\u0027 END) ELSE \\u0027NA\\u0027 END)) and (co1_tgt - co1 \\u003c\\u003e 0 ))\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":6,\"componentName\":\"SQL 6\",\"tableName\":\"SQL_6\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[3],\"options\":{\"dbTable\":\"Select (CASE WHEN nvl(uk,\\u0027[null]\\u0027) \\u003d nvl(uk_tgt , \\u0027[null]\\u0027) THEN uk ELSE concat(\\u0027A : \\u0027,nvl(uk, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(uk_tgt , \\u0027[null]\\u0027) ) END) as uk ,(CASE WHEN nvl(co1,\\u0027[null]\\u0027) \\u003d nvl(co1_tgt , \\u0027[null]\\u0027) THEN co1 ELSE concat(\\u0027A : \\u0027,nvl(co1, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(co1_tgt , \\u0027[null]\\u0027) ,\\u0027\\r\\n\\u0027,\\u0027 V : \\u0027,(CASE WHEN co1_tgt is not null and co1 is not null THEN (CASE WHEN co1!\\u003d0 THEN round((co1_tgt -co1)*100/co1,5) ELSE \\u0027NA\\u0027 END) ELSE \\u0027NA\\u0027 END)) END) as co1 ,(CASE WHEN nvl(col3,\\u0027[null]\\u0027) \\u003d nvl(col3_tgt , \\u0027[null]\\u0027) THEN col3 ELSE concat(\\u0027A : \\u0027,nvl(col3, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(col3_tgt , \\u0027[null]\\u0027) ,\\u0027\\r\\n\\u0027,\\u0027 V : \\u0027,(CASE WHEN col3_tgt is not null and col3 is not null THEN (CASE WHEN col3!\\u003d0 THEN round((col3_tgt -col3)*100/col3,5) ELSE \\u0027NA\\u0027 END) ELSE \\u0027NA\\u0027 END)) END) as col3  from Data_Compare_3 where  nvl(hash_src,0) \\u003c\\u003e nvl(hash_tgt,0) and nvl(uk,\\u0027null\\u0027)  \\u003d nvl(uk_tgt,\\u0027null\\u0027)  and ((hash_tgt is not null and hash_src is not null))  or (((CASE WHEN co1_tgt is not null and co1 is not null THEN (CASE WHEN co1!\\u003d0 THEN round((co1_tgt -co1)*100/co1,5) \\u003e -1.0 or round((co1_tgt -co1)*100/co1,5) \\u003c 1.0 END) END)  and (co1_tgt - co1 \\u003c\\u003e 0 ))) or(((CASE WHEN col3_tgt is not null and col3 is not null THEN (CASE WHEN col3!\\u003d0 THEN round((col3_tgt -col3)*100/col3,5) \\u003e -1.0 or round((col3_tgt -col3)*100/col3,5) \\u003c 1.0 END) END)  and (col3_tgt - col3 \\u003c\\u003e 0 ))) \"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":7,\"componentName\":\"SQL 7\",\"tableName\":\"SQL_7\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[3],\"options\":{\"dbTable\":\"\\r\\nSelect nvl(CAST( uk AS string) , \\u0027[null]\\u0027) as uk ,(CASE WHEN nvl(co1,\\u0027[null]\\u0027) \\u003d nvl(co1_tgt , \\u0027[null]\\u0027) THEN co1 ELSE concat(\\u0027A : \\u0027,nvl(co1, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(co1_tgt , \\u0027[null]\\u0027) ,\\u0027\\r\\n\\u0027,\\u0027 V : \\u0027,(CASE WHEN co1_tgt is not null and co1 is not null THEN (CASE WHEN co1!\\u003d0 THEN round((co1_tgt -co1)*100/co1,5) ELSE \\u0027NA\\u0027 END) ELSE \\u0027NA\\u0027 END)) END) as co1 ,(CASE WHEN nvl(col3,\\u0027[null]\\u0027) \\u003d nvl(col3_tgt , \\u0027[null]\\u0027) THEN col3 ELSE concat(\\u0027A : \\u0027,nvl(col3, \\u0027[null]\\u0027),\\u0027\\r\\n\\u0027,\\u0027 B : \\u0027 ,nvl(col3_tgt , \\u0027[null]\\u0027) ,\\u0027\\r\\n\\u0027,\\u0027 V : \\u0027,(CASE WHEN col3_tgt is not null and col3 is not null THEN (CASE WHEN col3!\\u003d0 THEN round((col3_tgt -col3)*100/col3,5) ELSE \\u0027NA\\u0027 END) ELSE \\u0027NA\\u0027 END)) END) as col3   from Data_Compare_3 where hash_src \\u003d hash_tgt and nvl(uk,\\u0027null\\u0027)  \\u003d nvl(uk_tgt,\\u0027null\\u0027)   and (((CASE WHEN co1_tgt is not null or co1 is not null THEN (CASE WHEN co1!\\u003d0 THEN round((co1_tgt -co1)*100/co1,5) \\u003e\\u003d -1.0 and round((co1_tgt -co1)*100/co1,5) \\u003c\\u003d 1.0 END) END)  or (co1_tgt - co1 \\u003d 0 ))) and(((CASE WHEN col3_tgt is not null or col3 is not null THEN (CASE WHEN col3!\\u003d0 THEN round((col3_tgt -col3)*100/col3,5) \\u003e\\u003d -1.0 and round((col3_tgt -col3)*100/col3,5) \\u003c\\u003d 1.0 END) END)  or (col3_tgt - col3 \\u003d 0 ))) \"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":7,"livyOptions":null,"isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}