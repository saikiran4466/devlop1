{"dataflow":{"dfKey":"6ed7ef8d-fd6b-4c96-b956-078d8661fecc","name":"tableau_test_upendar_end_to_end","tags":null,"description":null,"definition":"{\"name\":\"tableau_test_upendar_end_to_end\",\"version\":0,\"livyServerId\":0,\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"workSheets\":[{\"name\":\"Sale Map\",\"datasetName\":\"Sale_Map\"},{\"name\":\"Sales by Segment\",\"datasetName\":\"Sales_by_Segment\"}],\"reportViewPath\":\"Superstore_16572667761160/Overview\",\"filters\":[{\"name\":\"Order Date\",\"type\":\"quantitative\",\"min\":{\"value\":\"2020-02-09\",\"formattedValue\":\"2/9/2020\"},\"max\":{\"value\":\"2021-12-30\",\"formattedValue\":\"12/30/2021\"},\"workSheets\":[\"Total Sales\",\"Sale Map\",\"Sales by Product\",\"Sales by Segment\",\"Tooltip: Profit Ratio by City\"],\"dataType\":\"date\"},{\"name\":\"AGG(Profit Ratio)\",\"type\":\"quantitative\",\"min\":{\"value\":0.16,\"formattedValue\":\"16.0%\"},\"max\":{\"value\":0.3698366154512011,\"formattedValue\":\"37.0%\"},\"workSheets\":[\"Sale Map\"],\"dataType\":\"number\"}],\"parameters\":[],\"marks\":[],\"viewType\":\"dashboard\",\"viewTitle\":\"Workbook: Superstore\",\"componentId\":1,\"componentName\":\"Tableau 1\",\"tableName\":\"\",\"category\":\"Source\",\"componentType\":\"Tableau\",\"rank\":0,\"dataSourceName\":\"Tableau_Online_sastry\",\"displayRows\":50,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.BIComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"workSheets\":[{\"name\":\"Sale Map\",\"datasetName\":\"Sale_Map1\"},{\"name\":\"Sales by Segment\",\"datasetName\":\"Sales_by_Segment1\"},{\"name\":\"Sales by Product\",\"datasetName\":\"Sales_by_Product1\"},{\"name\":\"Total Sales\",\"datasetName\":\"Total_Sales1\"}],\"reportViewPath\":\"Superstore_16572667761160/Overview\",\"filters\":[{\"name\":\"AGG(Profit Ratio)\",\"type\":\"quantitative\",\"min\":{\"value\":0.15,\"formattedValue\":\"15.0%\"},\"max\":{\"value\":0.3698366154512011,\"formattedValue\":\"37.0%\"},\"workSheets\":[\"Sale Map\"],\"dataType\":\"number\"}],\"parameters\":[],\"marks\":[],\"viewType\":\"dashboard\",\"viewTitle\":\"Workbook: Superstore\",\"componentId\":2,\"componentName\":\"Tableau 2\",\"tableName\":\"\",\"category\":\"Source\",\"componentType\":\"Tableau\",\"rank\":0,\"dataSourceName\":\"Tableau_Online_sastry\",\"displayRows\":50,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.BIComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"workSheets\":[{\"name\":\"College\",\"datasetName\":\"College\"}],\"reportViewPath\":\"Regional_16578700410810/College\",\"filters\":[],\"parameters\":[],\"marks\":[{\"sheetName\":\"College\",\"markPairs\":[{\"name\":\"AVG(Math)\",\"value\":\"630.7\"},{\"name\":\"AVG(Verbal)\",\"value\":\"559.3\"},{\"name\":\"AVG(Writing)\",\"value\":\"595.0\"},{\"name\":\"Total Score\",\"value\":\"1785\"},{\"name\":\"College\",\"value\":\"Arts \\u0026 Sciences\"},{\"name\":\"SUM(1)\",\"value\":\"212\"},{\"name\":\"SUM(True Average)\",\"value\":\"1612\"}]}],\"viewType\":\"worksheet\",\"viewTitle\":\"Workbook: Regional\",\"componentId\":3,\"componentName\":\"Tableau 3\",\"tableName\":\"\",\"category\":\"Source\",\"componentType\":\"Tableau\",\"rank\":0,\"dataSourceName\":\"tabluea2\",\"displayRows\":50,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.BIComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"visuals\":[{\"id\":\"aca6bb07874b579ca077\",\"name\":\"BaseRate by DepartmentName\",\"datasetName\":\"BaseRate_by_DepartmentName\"},{\"id\":\"6d5273cd74266fb19311\",\"name\":\"BaseRate by Year and DepartmentName\",\"datasetName\":\"BaseRate_by_Year_and_DepartmentName\"},{\"id\":\"14643ad6c0c9b5f79195\",\"name\":\"LastOrderYear by DepartmentName\",\"datasetName\":\"LastOrderYear_by_DepartmentName\"},{\"id\":\"5b45f31dc021eb207f72\",\"name\":\"Slicer\",\"datasetName\":\"Slicer\"}],\"slicers\":\"\",\"bookmark\":\"H4sIAAAAAAAAA+1YS0/bQBD+K2gvvUSV7cQ24QZJEFJpS0OFVFUcxvbYWdh4rfU64Eb57521nRAgBCktpNDcvDP7+OabpzxlEc8zAeUXGCM7YEdSXo9BXe/ZrMXS+7L9OLAD33e7jucEoe35Hli0S2aayzRnB1OmQSWoL3hegDAXkvDnZYuBEGeQmFUMIscWy1DlMgXBf2G9ea6atRjeZkIqMHeea9Bo7p3QfloTFvtjm56EUPMJnmOoa+kQM6l0s3ad2I9iCztBu22Bg/ttN6Qzea2tcD6/3zxaIevJVANPCYCRQQheEFj+vt8JXL8bguX7Rh5zoZstQTm4zRQZTnSUmeGvR1YkUvEQBKvsU5jX5kxZT4piXH0N7snPZaFCHGJcqVLNdUk39fl4MCZ6SkQ2I67OlCQqaxVmoPQYU1150mhH8qankB6P2IE1ay3wHEYTSEOSPgRzmCQKE9DNcvAySI8gx6FxrJEfF2njROsx5EuS5DxNRBMld175XluSceyNyGwThcEVudN4gA5JFaE6Kisn9Lmax4nTeoB92waThSTyItfx22HkdxzPoxzrtm372aB60oknHBWocFSe4gTFY/gL/WPVHPMFKF4nYGXqphQ0JWVxG7vHygn5pT9nZQkUM8K9O4FRN6awHwhqbWivS7X3TMy3grIAd9ys4uYzVfDRZgXxPdPSh3LjcNl1rT/pWoLGiZ4ockpYjGqAPTkO5MpWVo86BORqaX5pfFM3uPccpE3BpzZJQrvjddoQeaEVdgM39rt21928T/7dsBlijkI0FXjJ6FPI9VczjSxa19rYeYPpt9XwW8TT+tA7LoQwWw9NoKT08QnL/2PueCWCnuqxr10LXy4z6hLkBh03bttRaDk2Bo7lx77zRkf1Xer8GwS96dF9y+Vl157WjPLP1t5c8JACb7nIsjGqpLIwAg1VEctqnBxrvYwqNVY1bspOOUGu774AUZhrP/TpRCRv0g8Eav6PY2Xprk7k2x9iX7cUXlaszFbTLgudZxDiGaS4gn6iHdLI+HetC6p/qQv2Z7PfF0a0oeYVAAA\\u003d\",\"pageName\":\"ReportSection52f7df0e4b330a2e835c\",\"reportId\":\"2a079976-fa0e-47e4-ab87-25c4351421bc\",\"embedUrl\":\"https://app.powerbi.com/reportEmbed?reportId\\u003d2a079976-fa0e-47e4-ab87-25c4351421bc\\u0026groupId\\u003d57e52937-773e-4842-9157-a1dd3589d029\\u0026w\\u003d2\\u0026config\\u003deyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLUlORElBLUNFTlRSQUwtQS1QUklNQVJZLXJlZGlyZWN0LmFuYWx5c2lzLndpbmRvd3MubmV0IiwiZW1iZWRGZWF0dXJlcyI6eyJtb2Rlcm5FbWJlZCI6dHJ1ZSwidXNhZ2VNZXRyaWNzVk5leHQiOnRydWV9fQ%3d%3d\",\"reportName\":\"Adventure Works\",\"componentId\":4,\"componentName\":\"Power BI 4\",\"tableName\":\"\",\"category\":\"Source\",\"componentType\":\"Power BI\",\"rank\":0,\"dataSourceName\":\"Power BI_Test2027\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.PowerBiComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import config\\n\\nprint(config.app_version)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":6,\"componentName\":\"Code 6\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"from datetime import datetime\\n\\nd \\u003d datetime.strptime(\\\"2023-03-16 16:06:56.265224\\\", \\\"%Y-%m-%d %H:%M:%S.%f\\\")\\n\\n\\nprint(d.strftime(\\\"%-m/%d/%Y\\\"))\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":7,\"componentName\":\"Code 7\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"\\nfrom datagaps_utilities import config\\n\\nprint(config.web_driver_location)\\nprint(config.browser_location)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":8,\"componentName\":\"Code 8\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"from py4j.java_gateway import java_import\\njava_import(spark._sc._jvm, \\\"org.apache.spark.sql.api.python.*\\\")\\nfrom datagaps_utilities import json_to_rdb\\njson_to_rdb(session_object\\u003dspark,data\\u003d[{\\n\\\"a\\\":7,\\\"b\\\":5, \\\"c\\\":[{\\\"d\\\":89, \\\"h\\\":98}], \\\"k\\\":[{\\\"gg\\\":89,\\\"uu\\\":77}, {\\\"gg\\\":56,\\\"uu\\\":77}]\\n},\\n{\\n\\\"a\\\":7,\\\"b\\\":5, \\\"c\\\":[{\\\"d\\\":89, \\\"h\\\":98}], \\\"k\\\":[{\\\"gg\\\":89,\\\"uu\\\":77}, {\\\"gg\\\":56,\\\"uu\\\":77}]\\n}], primary_table_name\\u003d\\\"table3\\\", use_short_names\\u003dFalse, parse_all_strings\\u003dFalse, component_name\\u003d\\\"Code 10\\\",dataflow_run_id\\u003d$[dataflow_run_id],dataflow_id\\u003d\\\"$[dataflow_id]\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":9,\"componentName\":\"Code 10\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"from py4j.java_gateway import java_import\\njava_import(spark._sc._jvm, \\\"org.apache.spark.sql.api.python.*\\\")\\nfrom datagaps_utilities import json_to_rdb\\njson_to_rdb(session_object\\u003dspark,file_path\\u003d\\\"/home/datagaps/upendar/json_files/Nebula_usecase2JSON-Course.json\\\", primary_table_name\\u003d\\\"table4\\\", use_short_names\\u003dFalse, parse_all_strings\\u003dFalse, component_name\\u003d\\\"Code 11\\\",dataflow_run_id\\u003d$[dataflow_run_id],dataflow_id\\u003d\\\"$[dataflow_id]\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":11,\"componentName\":\"Code 11\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"from py4j.java_gateway import java_import\\njava_import(spark._sc._jvm, \\\"org.apache.spark.sql.api.python.*\\\")\\nfrom datagaps_utilities import json_to_rdb\\njson_to_rdb(session_object\\u003dspark,file_path\\u003d\\\"/home/datagaps/upendar/json_files/Nebula_usecase2JSON-Course.json\\\", primary_table_name\\u003d\\\"table4\\\", use_short_names\\u003dFalse, parse_all_strings\\u003dFalse, component_name\\u003d\\\"Code 11\\\",dataflow_run_id\\u003d$[dataflow_run_id],dataflow_id\\u003d\\\"$[dataflow_id]\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":12,\"componentName\":\"Code 12\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"format\":\"json\",\"enableSchema\":\"N\",\"schema\":[],\"fileMetadata\":[],\"enableTrim\":\"N\",\"componentId\":13,\"componentName\":\"File 13\",\"tableName\":\"File_13\",\"category\":\"Source\",\"componentType\":\"File\",\"rank\":0,\"dataSourceName\":\"JSON_upendar\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"mode\":\"PERMISSIVE\",\"dateFormat\":\"yyyy-MM-dd\",\"multiLine\":\"true\",\"timestampFormat\":\"yyyy-MM-dd \\u0027T\\u0027 HH:mm:ss.SSSXXX\",\"path\":\"Nebula_usecase2JSON-Course.json\",\"inferSchema\":\"true\"},\"className\":\"com.datagaps.dataflow.models.FileComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"import json\\r\\nfrom pyspark.sql.functions import col\\r\\nimport traceback  \\r\\ntry:\\r\\n    unique_columns\\u003d\\\"transactionType\\\"\\r\\n    sdf \\u003d spark.sql(f\\\"select * from File_13\\\")\\r\\n    schema \\u003d [json.loads(i.json()) for i in sdf.schema.fields]\\r\\n    unique_cols \\u003d [i.strip() for i in unique_columns.split(\\\",\\\")]\\r\\n    object_cols \\u003d [col(i[\\\"name\\\"]) for i in schema if type(i[\\\"type\\\"]) !\\u003d str]\\r\\n    non_object_cols \\u003d [col(i[\\\"name\\\"]) for i in schema if type(i[\\\"type\\\"]) \\u003d\\u003d str]\\r\\n    \\r\\n    non_object_col_names \\u003d [i[\\\"name\\\"] for i in schema if type(i[\\\"type\\\"]) \\u003d\\u003d str]\\r\\n    print(unique_cols)\\r\\n    print(non_object_cols)\\r\\n    print(non_object_col_names)\\r\\n\\r\\n    if not set(unique_cols) \\u003c\\u003d set(non_object_col_names):\\r\\n        raise Exception(\\\"Unique columns should not be object type\\\")\\r\\n        \\r\\n    print(\\\"done\\\")\\r\\n    \\r\\n    \\r\\nexcept:\\r\\n    print(traceback.format_exc())\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":16,\"componentName\":\"Code 16\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"\\nfrom datagaps_utilities import dataset_to_rdb\\ndataset_to_rdb(session_object\\u003dspark,dataset_name\\u003d \\\"File_13\\\",primary_table_name\\u003d\\\"upendar_rdb\\\", use_short_names\\u003dFalse,parse_all_strings\\u003dFalse, component_name\\u003d\\\"Code 14\\\", dataflow_run_id\\u003d$[dataflow_run_id], dataflow_id\\u003d\\\"$[dataflow_id]\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":14,\"componentName\":\"Code 14\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[13],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"import traceback  \\ntry:\\n    from datagaps_utilities import dataset_flatten\\n    dataset_flatten(session_object\\u003dspark,input_dataset\\u003d \\\"File_13\\\", component_name\\u003d\\\"Code 15\\\", dataflow_run_id\\u003d$[dataflow_run_id], output_dataset_1\\u003d\\\"out1\\\",output_dataset_2\\u003d\\\"out2\\\",unique_columns\\u003d\\\"transactionType\\\")\\n    \\nexcept:\\n    print(traceback.format_exc())\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":15,\"componentName\":\"Code 15\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[13],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":16,"livyOptions":"{\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":0,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":\"\",\"conf\":{},\"heartbeatTimeoutInSecond\":0,\"kind\":\"spark\"}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow/upendar","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}