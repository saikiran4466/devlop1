{"dataflow":{"dfKey":"41e1f833-6d3c-402d-b103-0169767e9b84","name":"PowerBI_upendar","tags":null,"description":"","definition":"{\"name\":\"PowerBI_upendar\",\"description\":\"\",\"version\":0,\"livyServerId\":0,\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import get_power_bi_data \\r\\nget_power_bi_data(spark,5324,16990,r\\u0027\\u0027\\u0027{\\\"visuals\\\":[{\\\"name\\\":\\\"1fca5a0eb2e16eadd360\\\",\\\"datasetName\\\":\\\"vis1\\\"}, {\\\"name\\\":\\\"4752d44bec99dcb932a2\\\",\\\"datasetName\\\":\\\"vis2\\\"},{\\\"name\\\":\\\"867cbe4950d095593b89\\\",\\\"datasetName\\\":\\\"vis3\\\"}],\\\"embededURL\\\":\\\"https://app.powerbi.com/reportEmbed?reportId\\u003d20518a01-ee77-46fb-a4c3-9251aa5e14fc\\u0026groupId\\u003dae71ee1f-1ffc-4ebe-9445-3f60da57d458\\u0026w\\u003d2\\u0026config\\u003deyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLUlORElBLUNFTlRSQUwtQS1QUklNQVJZLXJlZGlyZWN0LmFuYWx5c2lzLndpbmRvd3MubmV0IiwiZW1iZWRGZWF0dXJlcyI6eyJtb2Rlcm5FbWJlZCI6dHJ1ZSwidXNhZ2VNZXRyaWNzVk5leHQiOnRydWV9fQ%3d%3d\\\",\\\"report_filters\\\":[],\\\"page_filters\\\":[],\\\"visual_filters\\\":{}, \\\"slicers\\\":{},\\\"token\\\":\\\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvM2Q4NjZmMWUtMzUzYi00ZDhkLWFmZTItNzY4MjkwZjlmODViLyIsImlhdCI6MTY3NTA3NzI4NiwibmJmIjoxNjc1MDc3Mjg2LCJleHAiOjE2NzUwODE2MTYsImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJBVFFBeS84VEFBQUF6cXExS0JWbkJ3OVlKOVZmdGI5Y3hRd3g3emZEVzB5UjhEZmJZM0lrY2pUOERSc1dWVEZQZzZXMndiK28xZURJIiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6IjcyMWJhYjBmLTJiMmItNDVkYi1hZmYyLTRiYjFkZWVhNTU2OCIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiUiIsImdpdmVuX25hbWUiOiJQcmFuaXRoYSIsImlwYWRkciI6IjEwMy42OS4yOS4xOTYiLCJuYW1lIjoiUHJhbml0aGEgUiIsIm9pZCI6IjBlNzllNmQzLTMwZGYtNDUxYy1iMzYxLTM3YzU5MjYxYzAzZSIsInB1aWQiOiIxMDAzMjAwMEE5QzE5RTBFIiwicmgiOiIwLkFVa0FIbS1HUFRzMWpVMnY0bmFDa1BuNFd3a0FBQUFBQUFBQXdBQUFBQUFBQUFCSkFCUS4iLCJzY3AiOiJBcHAuUmVhZC5BbGwgQ2FwYWNpdHkuUmVhZC5BbGwgQ2FwYWNpdHkuUmVhZFdyaXRlLkFsbCBDb250ZW50LkNyZWF0ZSBEYXNoYm9hcmQuUmVhZC5BbGwgRGFzaGJvYXJkLlJlYWRXcml0ZS5BbGwgRGF0YWZsb3cuUmVhZC5BbGwgRGF0YWZsb3cuUmVhZFdyaXRlLkFsbCBEYXRhc2V0LlJlYWQuQWxsIERhdGFzZXQuUmVhZFdyaXRlLkFsbCBHYXRld2F5LlJlYWQuQWxsIEdhdGV3YXkuUmVhZFdyaXRlLkFsbCBQaXBlbGluZS5EZXBsb3kgUGlwZWxpbmUuUmVhZC5BbGwgUGlwZWxpbmUuUmVhZFdyaXRlLkFsbCBSZXBvcnQuUmVhZC5BbGwgUmVwb3J0LlJlYWRXcml0ZS5BbGwgU3RvcmFnZUFjY291bnQuUmVhZC5BbGwgU3RvcmFnZUFjY291bnQuUmVhZFdyaXRlLkFsbCBUZW5hbnQuUmVhZC5BbGwgVGVuYW50LlJlYWRXcml0ZS5BbGwgVXNlclN0YXRlLlJlYWRXcml0ZS5BbGwgV29ya3NwYWNlLlJlYWQuQWxsIFdvcmtzcGFjZS5SZWFkV3JpdGUuQWxsIiwic3ViIjoidkJ4ZGNLOXFUSHFFZ2drWmsxNThqbzc4VnRBUlpvNVVCc0NyRXBDNkhHOCIsInRpZCI6IjNkODY2ZjFlLTM1M2ItNGQ4ZC1hZmUyLTc2ODI5MGY5Zjg1YiIsInVuaXF1ZV9uYW1lIjoicHJhbml0aGFAZGF0YWdhcHMuY29tIiwidXBuIjoicHJhbml0aGFAZGF0YWdhcHMuY29tIiwidXRpIjoiM3NiQmZWSHI3VTZPVUtPXzdtdFFBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiZDI0YWVmNTctMTUwMC00MDcwLTg0ZGItMjY2NmYyOWNmOTY2IiwiYTllYTg5OTYtMTIyZi00Yzc0LTk1MjAtOGVkY2QxOTI4MjZjIiwiOWI4OTVkOTItMmNkMy00NGM3LTlkMDItYTZhYzJkNWVhNWMzIiwiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il19.eRQKwFQ5CqHfdGhSkPhwCuY3mpmImT6Zwf4wldms1UJAPhoO5OF8JMmxoUd1qd8UTKnksUl-jOqizf0lf5ILZoGWPKYXplY1itg26JT5KjnydIMukL4IaLa7-jktqH8Oa-frbGpV9HKWEPv3L6CusvLTRE_VBY6P2aCnWQSQrJNSN0QOzPWyswvmy5YVseqIy7LKfnd4HTEXDQQgzwgkcOfF0msBFy5DzR5vneRm7g4XL4FMBECYGSdQA0OmHWUD5YatnevhADM98wqrr7S70eOww_mRxB1jTF-KZqhi9IUe7BJpqTes4FmHcAhi-hk2S64xac91uclvCH27_qUIqg\\\",\\\"pageName\\\":\\\"ReportSection866b242ab6208d407078\\\",\\\"reportID\\\":\\\"20518a01-ee77-46fb-a4c3-9251aa5e14fc\\\"}\\u0027\\u0027\\u0027,r\\u0027\\u0027\\u0027{}\\u0027\\u0027\\u0027)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":1,\"componentName\":\"Code 123\",\"tableName\":\"code_123\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import config\\n\\nprint(config.root_folder)\\nprint(config.DB_HOST)\\nprint(config.DB_NAME)\\nprint(config.DB_USER)\\nprint(config.DB_PASSWORD)\\nprint(config.DB_PORT)\\n\\n\\nprint(config.browser_location)\\nprint(config.configs.get(\\\"browser_location\\\"))\\nprint(config.configs.get(\\\"abc\\\"))\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":4,\"componentName\":\"Code 4\",\"tableName\":\"code_4\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import dataset_flatten \\r\\nprint(\\\"hai\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":5,\"componentName\":\"Code 5\",\"tableName\":\"code_5\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"format\":\"json\",\"enableSchema\":\"N\",\"schema\":[],\"fileMetadata\":[],\"enableTrim\":\"N\",\"componentId\":6,\"componentName\":\"File 6\",\"tableName\":\"File_6\",\"category\":\"Source\",\"componentType\":\"File\",\"rank\":0,\"dataSourceName\":\"JSON_upendar\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"mode\":\"PERMISSIVE\",\"dateFormat\":\"yyyy-MM-dd\",\"multiLine\":\"true\",\"timestampFormat\":\"yyyy-MM-dd \\u0027T\\u0027 HH:mm:ss.SSSXXX\",\"path\":\"sample2.json\",\"inferSchema\":\"true\"},\"className\":\"com.datagaps.dataflow.models.FileComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import dataset_to_rdb \\r\\n\\r\\ndataset_to_rdb(spark,\\\"Code 9\\\",$[dataflow_run_id], \\\"$[dataflow_id]\\\", \\\"File_6\\\")\\r\\n\\r\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":9,\"componentName\":\"Code 9\",\"tableName\":\"code_9\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"\\n\\n\\nimport importlib.resources as pkg_resources\\n\\nfrom datagaps_utilities import static\\n\\nhtml_content \\u003d pkg_resources.read_text(static, \\u0027tableau_js_api3.html\\u0027)\\n\\n\\nprint(html_content)\\n\\n\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":13,\"componentName\":\"Code 13\",\"tableName\":\"code_13\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"# import OGTestUtilities\\n\\n# import importlib.resources as pkg_resources\\n# print(pkg_resources.read_text(OGTestUtilities, \\u0027configaration.cfg\\u0027))\\n# exit()\\n# from dummy_package_by_upendar import sss\\nimport dummy_package_by_upendar\\nimport importlib.resources as pkg_resources\\nprint(pkg_resources.read_text(dummy_package_by_upendar, \\u0027hello.cfg\\u0027))\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":14,\"componentName\":\"Code 14\",\"tableName\":\"code_14\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"format\":\"csv\",\"enableSchema\":\"N\",\"schema\":[],\"fileMetadata\":[],\"enableTrim\":\"N\",\"componentId\":16,\"componentName\":\"File 16\",\"tableName\":\"File_16\",\"category\":\"Source\",\"componentType\":\"File\",\"rank\":0,\"dataSourceName\":\"CSV_shared_folder_upendar\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"delimiter\":\",\",\"multiLine\":\"true\",\"header\":\"false\",\"inferSchema\":\"true\",\"path\":\"API.csv\"},\"className\":\"com.datagaps.dataflow.models.FileComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"import smbclient\\r\\nimport databricks.koalas as ks\\r\\nimport os\\r\\n\\r\\nconn_map\\u003dspark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.getConnectionParams(\\\"CSV_shared_folder_upendar\\\",\\\"read\\\")\\r\\nconn\\u003d[conn_map.toList().apply(i) for i in range(conn_map.size())]\\r\\nconn_details\\u003d {i._1(): i._2() for i in conn}\\r\\nshared_path\\u003dconn_details[\\\"path\\\"].split(\\\":\\\")[1]\\r\\nfile_path\\u003dos.path.join(shared_path,\\\"API.csv\\\")\\r\\nprint(file_path)\\r\\nif conn_details[\\\"impersonate\\\"]\\u003d\\u003d\\\"false\\\":\\r\\n\\tsmbclient.ClientConfig()\\r\\nelse:\\r\\n\\tusername\\u003dconn_details[\\\"userName\\\"]\\r\\n\\tpassword\\u003dspark.sparkContext._jvm.com.datagaps.core.engine.utils.CodeUtils.getDecryptedPassword(conn_details[\\\"password\\\"])\\r\\n\\tsmbclient.ClientConfig(username\\u003dusername, password\\u003dpassword)\\r\\n\\t\\r\\n\\t\\r\\nwith smbclient.open_file(r\\\"\\\\\\\\192.168.6.55\\\\data1\\\\upendar\\\\file438.txt\\\", mode\\u003d\\\"w\\\") as fd:\\r\\n    print(fd.write(\\\"hello world2\\\"))\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":17,\"componentName\":\"Code 17\",\"tableName\":\"code_17\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"pluginId\":\"7035c2e9-2175-4292-978f-6bc637d90493\",\"pluginName\":\"Plugin_602\",\"pluginOptions\":{\"parameters\":[],\"inputDatasets\":[],\"outputDatasets\":[],\"dataSources\":[{\"paramId\":\"6d6695a4-be90-41fd-90ee-3edcda1d461d\",\"fieldName\":\"aaaa\",\"displayName\":\"test1\",\"value\":\"1831\"}]},\"componentId\":19,\"componentName\":\"Plugin 19\",\"tableName\":\"Plugin_19\",\"category\":\"Processor\",\"componentType\":\"Plugin\",\"rank\":0,\"displayRows\":0,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.PluginComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"sourceDataFrame\":\"File_16\",\"targetDataFrame\":\"File_6\",\"mapping\":[{\"sourceColumn\":\"_c0\",\"sourceType\":\"string\",\"targetColumn\":\"class\",\"targetType\":\"string\",\"unique\":\"Y\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"string\",\"orginalTargetType\":\"string\"},{\"sourceColumn\":\"_c1\",\"sourceType\":\"string\",\"targetColumn\":\"class2\",\"targetType\":\"string\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"string\",\"orginalTargetType\":\"string\"},{\"sourceColumn\":\"_c2\",\"sourceType\":\"string\",\"targetColumn\":\"code\",\"targetType\":\"string\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"string\",\"orginalTargetType\":\"string\"},{\"sourceColumn\":\"_c3\",\"sourceType\":\"string\",\"targetColumn\":\"info\",\"targetType\":\"Object\",\"unique\":\"N\",\"sourceDataFormat\":\"\",\"targetDataFormat\":\"\",\"sourceTypeChange\":\"N\",\"targetTypeChange\":\"N\",\"originalSourceType\":\"string\",\"orginalTargetType\":\"Object\"}],\"onlyInA\":\"Y\",\"onlyInB\":\"Y\",\"difference\":\"Y\",\"enableTrim\":\"N\",\"replaceNull\":\"N\",\"autoDataTypeConversion\":\"N\",\"columnDifferencesCount\":\"Y\",\"ignoreCase\":\"N\",\"hasDuplicates\":\"N\",\"subDataFrames\":[{\"subDataFrameName\":\"_Source_Duplicate\",\"type\":\"Duplicates In A\"},{\"subDataFrameName\":\"_Target_Duplicate\",\"type\":\"Duplicates In B\"},{\"subDataFrameName\":\"_Matched\",\"type\":\"Matched\"},{\"subDataFrameName\":\"_OnlySource\",\"type\":\"Only In A\"},{\"subDataFrameName\":\"_OnlyTarget\",\"type\":\"Only In B\"},{\"subDataFrameName\":\"_Difference\",\"type\":\"Difference\"},{\"subDataFrameName\":\"_Column_Difference\",\"type\":\"Difference Column\"}],\"onlyInAThresholdUnit\":\"number\",\"onlyInAThreshold\":0.0,\"onlyInBThresholdUnit\":\"number\",\"onlyInBThreshold\":0.0,\"differencesSourceThresholdUnit\":\"number\",\"differencesSourceThreshold\":0.0,\"differencesTargetThresholdUnit\":\"number\",\"differencesTargetThreshold\":0.0,\"componentId\":21,\"componentName\":\"Data Compare 21\",\"tableName\":\"Data_Compare_21\",\"category\":\"Data Quality\",\"componentType\":\"Data Compare\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.DataCompareComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"code\":\"import time\\r\\nfrom selenium.webdriver.chrome.service import Service\\r\\nfrom webdriver_manager.chrome import ChromeDriverManager\\r\\nfrom selenium import webdriver\\r\\n\\r\\nurl \\u003d \\\"https://www.google.co.in/\\\"\\r\\n# url \\u003d \\\"chrome://settings/help\\\"\\r\\n\\r\\noptions \\u003d webdriver.ChromeOptions()\\r\\n\\r\\noptions.add_argument(\\u0027headless\\u0027)\\r\\n# options.binary_location \\u003d \\\"C:\\\\\\\\Users\\\\\\\\upend\\\\\\\\Downloads\\\\\\\\chrome-win\\\\\\\\chrome-win\\\\\\\\chrome.exe\\\" # for chromium\\r\\noptions.binary_location \\u003d \\\"/usr/bin/chromium-browser2\\\" # for chromium\\r\\n\\r\\n# driver \\u003d webdriver.Chrome(service\\u003dService(\\\"C:\\\\\\\\Users\\\\\\\\upend\\\\\\\\Downloads\\\\\\\\chromedriver_win32\\\\\\\\chromedriver.exe\\\"), options\\u003doptions)\\r\\ndriver \\u003d webdriver.Chrome(ChromeDriverManager().install(), options\\u003doptions)\\r\\n# driver.fullscreen_window()\\r\\n# driver.set_window_size(1920, 1080)\\r\\ndriver.implicitly_wait(30)\\r\\ndriver.get(url)\\r\\ntime.sleep(2)\\r\\ndriver.save_screenshot(\\\"/home/datagaps/upendar/google_home_page4.png\\\")\\r\\nprint(\\\"done\\\")\\r\\ntime.sleep(5)\\r\\ndriver.quit()\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":23,\"componentName\":\"Code 23\",\"tableName\":\"code_23\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"print(\\\"heelo works\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":24,\"componentName\":\"Code 24\",\"tableName\":\"code_24\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import get_power_bi_data \\r\\nget_power_bi_data(spark,$[dataflow_run_id],38652,r\\u0027\\u0027\\u0027{\\\"visuals\\\":[{\\\"name\\\":\\\"c946fec379279e44958f\\\",\\\"datasetName\\\":\\\"vis11\\\"}, {\\\"name\\\":\\\"ec70b2cb0b0baf1e5522\\\",\\\"datasetName\\\":\\\"vis12\\\"},{\\\"name\\\":\\\"926ca022256068288593\\\",\\\"datasetName\\\":\\\"vis13\\\"},{\\\"name\\\":\\\"a8a13cbe04ad0be654dd\\\",\\\"datasetName\\\":\\\"vis14\\\"}],\\\"embededURL\\\":\\\"https://app.powerbi.com/reportEmbed?reportId\\u003dd07514ec-8253-44cd-b625-c39ffdf65591\\u0026groupId\\u003dfc826c3c-db0a-4b2a-b7a3-15b38cfa3515\\u0026w\\u003d2\\u0026config\\u003deyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLUlORElBLUNFTlRSQUwtQS1QUklNQVJZLXJlZGlyZWN0LmFuYWx5c2lzLndpbmRvd3MubmV0IiwiZW1iZWRGZWF0dXJlcyI6eyJtb2Rlcm5FbWJlZCI6dHJ1ZSwidXNhZ2VNZXRyaWNzVk5leHQiOnRydWV9fQ%3d%3d\\\",\\\"report_filters\\\":[],\\\"page_filters\\\":[{\\r\\n                        \\\"$schema\\\": \\\"http://powerbi.com/product/schema#basic\\\",\\r\\n                        \\\"target\\\": {\\r\\n                            \\\"table\\\": \\\"Budget2016\\\",\\r\\n                            \\\"column\\\": \\\"CountryRegion\\\"\\r\\n                        },\\r\\n                        \\\"filterType\\\": 1,\\r\\n                        \\\"operator\\\": \\\"In\\\",\\r\\n                        \\\"values\\\": [\\r\\n                            \\\"China\\\"                        ],\\r\\n                        \\\"requireSingleSelection\\\": false\\r\\n                    }],\\\"visual_filters\\\":{}, \\\"slicers\\\":{},\\\"token\\\":\\\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvM2Q4NjZmMWUtMzUzYi00ZDhkLWFmZTItNzY4MjkwZjlmODViLyIsImlhdCI6MTY3NTI2MjcyOSwibmJmIjoxNjc1MjYyNzI5LCJleHAiOjE2NzUyNjgwNjEsImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJBVFFBeS84VEFBQUErbDBpeDA2Z3ZXR0diZ0d3THp2dmlqYTdjcG10S1BybkhsMm9oSnpRNXNKWUZKelA4MUQzMXNQQmJRRVdWb3FsIiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6IjcyMWJhYjBmLTJiMmItNDVkYi1hZmYyLTRiYjFkZWVhNTU2OCIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiUiIsImdpdmVuX25hbWUiOiJQcmFuaXRoYSIsImlwYWRkciI6IjEwMy42OS4yOS4xOTgiLCJuYW1lIjoiUHJhbml0aGEgUiIsIm9pZCI6IjBlNzllNmQzLTMwZGYtNDUxYy1iMzYxLTM3YzU5MjYxYzAzZSIsInB1aWQiOiIxMDAzMjAwMEE5QzE5RTBFIiwicmgiOiIwLkFVa0FIbS1HUFRzMWpVMnY0bmFDa1BuNFd3a0FBQUFBQUFBQXdBQUFBQUFBQUFCSkFCUS4iLCJzY3AiOiJBcHAuUmVhZC5BbGwgQ2FwYWNpdHkuUmVhZC5BbGwgQ2FwYWNpdHkuUmVhZFdyaXRlLkFsbCBDb250ZW50LkNyZWF0ZSBEYXNoYm9hcmQuUmVhZC5BbGwgRGFzaGJvYXJkLlJlYWRXcml0ZS5BbGwgRGF0YWZsb3cuUmVhZC5BbGwgRGF0YWZsb3cuUmVhZFdyaXRlLkFsbCBEYXRhc2V0LlJlYWQuQWxsIERhdGFzZXQuUmVhZFdyaXRlLkFsbCBHYXRld2F5LlJlYWQuQWxsIEdhdGV3YXkuUmVhZFdyaXRlLkFsbCBQaXBlbGluZS5EZXBsb3kgUGlwZWxpbmUuUmVhZC5BbGwgUGlwZWxpbmUuUmVhZFdyaXRlLkFsbCBSZXBvcnQuUmVhZC5BbGwgUmVwb3J0LlJlYWRXcml0ZS5BbGwgU3RvcmFnZUFjY291bnQuUmVhZC5BbGwgU3RvcmFnZUFjY291bnQuUmVhZFdyaXRlLkFsbCBUZW5hbnQuUmVhZC5BbGwgVGVuYW50LlJlYWRXcml0ZS5BbGwgVXNlclN0YXRlLlJlYWRXcml0ZS5BbGwgV29ya3NwYWNlLlJlYWQuQWxsIFdvcmtzcGFjZS5SZWFkV3JpdGUuQWxsIiwic3ViIjoidkJ4ZGNLOXFUSHFFZ2drWmsxNThqbzc4VnRBUlpvNVVCc0NyRXBDNkhHOCIsInRpZCI6IjNkODY2ZjFlLTM1M2ItNGQ4ZC1hZmUyLTc2ODI5MGY5Zjg1YiIsInVuaXF1ZV9uYW1lIjoicHJhbml0aGFAZGF0YWdhcHMuY29tIiwidXBuIjoicHJhbml0aGFAZGF0YWdhcHMuY29tIiwidXRpIjoieEZzRmlWcUZua3FWSkxESlhhRVBBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiZDI0YWVmNTctMTUwMC00MDcwLTg0ZGItMjY2NmYyOWNmOTY2IiwiYTllYTg5OTYtMTIyZi00Yzc0LTk1MjAtOGVkY2QxOTI4MjZjIiwiOWI4OTVkOTItMmNkMy00NGM3LTlkMDItYTZhYzJkNWVhNWMzIiwiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il19.sS_hDWg-TweeFivL2S4kDSgNWbAu8rkvnOmftno9ovEzWrqPZttIKAXQm0UrqGVW_o3WOgyUospuq9z_BxGt6zZKAKn1pHkjQAK8pBQjzT2hbFItszHKaK_-QnrUzbeMNb3OtF8eLai6PC9mdHTLxNk4Z58lIirQ_2v87Id9bkGq1CPgkiyHyYS1MqyZ26sAPiIXaXOPToAhc7r4jz3gSkIP-NxYEtEIYVJ80CdM6WNjTFUckguP2yFrN9MEY8cCv0sWZld0hCq1Xi39FZyNe3U6l3wp2SL32_wliGEk9ZSOi1WJADc8nm2ztDmT9TAkN5F6Gcx2dQTM9JY8L0pmPQ\\\",\\\"pageName\\\":\\\"ReportSection\\\",\\\"reportID\\\":\\\"d07514ec-8253-44cd-b625-c39ffdf65591\\\"}\\u0027\\u0027\\u0027,r\\u0027\\u0027\\u0027{}\\u0027\\u0027\\u0027)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":25,\"componentName\":\"Code 25\",\"tableName\":\"code_25\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import get_power_bi_data \\r\\nget_power_bi_data(spark,$[dataflow_run_id],38652,r\\u0027\\u0027\\u0027{\\\"visuals\\\":[{\\\"id\\\":\\\"c946fec379279e44958f\\\",\\\"datasetName\\\":\\\"vis11\\\"}, {\\\"id\\\":\\\"ec70b2cb0b0baf1e5522\\\",\\\"datasetName\\\":\\\"vis12\\\"},{\\\"id\\\":\\\"926ca022256068288593\\\",\\\"datasetName\\\":\\\"vis13\\\"},{\\\"id\\\":\\\"a8a13cbe04ad0be654dd\\\",\\\"datasetName\\\":\\\"vis14\\\"}],\\\"embedUrl\\\":\\\"https://app.powerbi.com/reportEmbed?reportId\\u003dd07514ec-8253-44cd-b625-c39ffdf65591\\u0026groupId\\u003dfc826c3c-db0a-4b2a-b7a3-15b38cfa3515\\u0026w\\u003d2\\u0026config\\u003deyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLUlORElBLUNFTlRSQUwtQS1QUklNQVJZLXJlZGlyZWN0LmFuYWx5c2lzLndpbmRvd3MubmV0IiwiZW1iZWRGZWF0dXJlcyI6eyJtb2Rlcm5FbWJlZCI6dHJ1ZSwidXNhZ2VNZXRyaWNzVk5leHQiOnRydWV9fQ%3d%3d\\\",\\\"filters\\\":\\\"\\\", \\\"slicers\\\":\\\"\\\", \\\"bookmark\\\":\\\"H4sIAAAAAAAAA+1Y3W/bNhD/VwK+9MUY+CFSUt4aLxkGDEWQbNnDkIcTPxS1sihQVFYv8P++E2WvS9ygboFmxhDbgMTj3fE+fnck/UBMM/QtrN/BypJTcub9hxWEDyeMLEj3mGYzYSvOXC7AqUzzkpcWuXwfG98N5PSBRAi1jTfNMEI7KUTiH7cLAm17CfU0ctAOdkF6GwbfQdv8ZWfm3dRmQezHvvUBJp3XEaKd9N4jP47RFvaDwCVBx+beXlsdZ+qV7X2Iu/GCuKaNKDKJVuvzj31AOx527lykSVpIpZhjpdK8qnQpmaIoGdf9xLPEhWsfGg0tSSYFO8wWPJClb8dVejt/RL/2Y9D2yro01cUmrqfgjQZDwilTZIPeXQaPzs8zATqTiHf+z2WwuKQhp2yzeGKpNVTnQqmSQWUyyGUhXtjSpR+7GNZXtp4U7Ft8i5RhDn6K+eN0IOGAfIgqF6ykJacGf5lQTGXPeTmrm7Td7IDBF+Qi+FXSu4VyhZyfc25Bfk1K6Qah+fsdBjhJLX1nmp3B73zcD9vPT0I5bOUOCPI8SEZ9IbZo0w20Yyod1P5Lg56i05OvExkl3vzWIdGcpOoY3iSZZzh/smEF3Trx3G6mz+3mvwLJU1gLKLM8A4kPoCzLnbbiOAvQZVwq7jSVAmEJmgnGPln61txDp1Hyu5mZZk7+mdqvvfvUQxHAEZpuW2e6zJSzWuQlz0ubZaUs3IGlKJ1SRS4KIzVzlkkj3LOl+JKZoVNmvhT1t3UdbA27Qj5/kZRcjN2219F9o1N3bLq63e51aUNLb3MfIrodh9TnzyAs7yDEaVOt3mP7nNKE0j4YG87WKVM/NmHXV7HnnR+Z71P7mjdnlHj/ry1hi5r14S3zK2AytTbEgc5pxXVF8QuOWSk5PxDxjhtjSs5oJTMpqLK42b4i/vsh3vhujK9Q/2aol1xpoJzjvkRVwYtCluJAqFdUsJzrjOscnCmlpAUc02ny/wr5FfRPsf5y6Nk7ZCYUQQFM6MrSDAytrJKZMQeiyNBMZdJVlSop5SXkwhzF7YnuHd4yCqzMi5wWzGionEb4v+L9tcUfd4tP9fkpamRlQ53+CfFjHHrQ9hK6+drazwoam/gQNqjEmu17uiN/5mIYAz7SGpizpmrtgfxb4/4GHVOFXTUSAAA\\u003d\\\",\\\"pageName\\\":\\\"ReportSection\\\",\\\"reportId\\\":\\\"d07514ec-8253-44cd-b625-c39ffdf65591\\\"}\\u0027\\u0027\\u0027,r\\u0027\\u0027\\u0027{\\r\\n  \\\"dataSourceId\\\": 2308,\\r\\n  \\\"dataSourceName\\\": \\\"PowerBI_Demo\\\",\\r\\n  \\\"optionsJson\\\": [\\r\\n    {\\r\\n      \\\"key\\\": \\\"applicationType\\\",\\r\\n      \\\"value\\\": \\\"Master_User\\\"\\r\\n    },\\r\\n    {\\r\\n      \\\"key\\\": \\\"applicationId\\\",\\r\\n      \\\"value\\\": \\\"721bab0f-2b2b-45db-aff2-4bb1deea5568\\\"\\r\\n    },\\r\\n    {\\r\\n      \\\"key\\\": \\\"userName\\\",\\r\\n      \\\"value\\\": \\\"pranitha@datagaps.com\\\"\\r\\n    },\\r\\n    {\\r\\n      \\\"key\\\": \\\"password\\\",\\r\\n      \\\"value\\\": \\\"U2FsdGVkX1+gJ4lUM3Vmba4cMBkn0gyfy/M2aE4N07k\\u003d\\\"\\r\\n    }\\r\\n  ]\\r\\n}\\u0027\\u0027\\u0027)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":28,\"componentName\":\"Code 28\",\"tableName\":\"code_28\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import get_power_bi_data\\r\\nget_power_bi_data(spark,20277,175171,\\u0027\\u0027\\u0027{\\\\\\\"visuals\\\\\\\":[{\\\\\\\"id\\\\\\\":\\\\\\\"VisualContainer5\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"Platforms\\\\\\\",\\\\\\\"datasetName\\\\\\\":\\\\\\\"Platforms\\\\\\\"},{\\\\\\\"id\\\\\\\":\\\\\\\"VisualContainer3\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"Views per day\\\\\\\",\\\\\\\"datasetName\\\\\\\":\\\\\\\"Views_per_day\\\\\\\"},{\\\\\\\"id\\\\\\\":\\\\\\\"VisualContainer10\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"Report page\\\\\\\",\\\\\\\"datasetName\\\\\\\":\\\\\\\"Report_page\\\\\\\"}],\\\\\\\"filters\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"slicers\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"bookmark\\\\\\\":\\\\\\\"H4sIAAAAAAAAA+1YUVPiMBD+Kzd58aVz0+Ip6psC3st5w6jHi8PD0i41GpJOkiKcw3+/TQqehQI3ioJz9qnZTXa//b500/aRJdxkAsY/YYDshJ0pdT8Aff8lYgGTZVt8dIy14zjc3z8IwzpAGNWBZqnMciUNO3lkFnSKtsNNDsIFJONNN2AgRBtSN+qDMBiwDLVREgT/jcXkmWsSMBxlQmlwMa8sWHRxhzSfxoQl+hpSSogtH+IVxrawXmKmtJ2NA2aKO4+p7HPBfMaGkha4pMDO1inbImczXKZiiu/vuutx5jixOLI9NXLl9+4otosymRD8uUg1t7LPhZ0m6o1bo0wTLURWEek0GYKMMWG+dI3GTHFeIJhc+/pbJceVynWMl9j3Lmm5HVOcDscHwxyEtlZE8JORMjdULq333aqHhkaiNWEn4SR4QtEgU6o0j6nWeSANJfKBfBWOphNyMX+XLCtpjn3qxi1oW6aaBjpBfTb2VDa5nulbC+ZQvgGNk+5sC9Kcu2d7bcpiAWpztHWrdta3tTtrc5o2ubGa93JX6AXaW5UsQPX94wUKG8Fj1CVx2QCpjbibBCz4irIiEcfCrxLvRl/wI/vBiYQidgdE7sLuNWlFoh7kntPLU7hEM7/CvECxfyelUr+Dd9SvLcD2lR58qraWikqt9rffxT97+CZJ3IkOfrjDu2q9qqCTHZKzgt6jjb3EHW8sUhS+Y9ev5K14HXav4/9X319PRuUzGq1v/ZsT7JdxSeYwnsOAi/GSg/otmn8liu8khdw2CGdsay5jnhXflyvB7HDztNAT2Brtdv+sb/94WvHp+iEOqNI3Y1V3ecXvgdM01ZjC7K9G67UHxSXIe+Kzcp84n3ec53LK2eE7S7LlcsNlCkY7oWBxkD17WJ6VdK0sabFQzkdV7wWl+qPdXX8A2ztabu4UAAA\\u003d\\\\\\\",\\\\\\\"pageName\\\\\\\":\\\\\\\"ReportSection\\\\\\\",\\\\\\\"reportId\\\\\\\":\\\\\\\"ff462b2c-4937-46c3-953a-d166793f1846\\\\\\\",\\\\\\\"embedUrl\\\\\\\":\\\\\\\"https://app.powerbi.com/reportEmbed?reportId\\u003dff462b2c-4937-46c3-953a-d166793f1846\\u0026groupId\\u003d57e52937-773e-4842-9157-a1dd3589d029\\u0026w\\u003d2\\u0026config\\u003deyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLUlORElBLUNFTlRSQUwtQS1QUklNQVJZLXJlZGlyZWN0LmFuYWx5c2lzLndpbmRvd3MubmV0IiwiZW1iZWRGZWF0dXJlcyI6eyJtb2Rlcm5FbWJlZCI6dHJ1ZSwidXNhZ2VNZXRyaWNzVk5leHQiOnRydWV9fQ%3d%3d\\\\\\\"}\\u0027\\u0027\\u0027,\\u0027\\u0027\\u0027{\\\\\\\"dataSourceId\\\\\\\":1896,\\\\\\\"dataSourceName\\\\\\\":\\\\\\\"PowerBI\\\\\\\",\\\\\\\"optionsJson\\\\\\\":[{\\\\\\\"key\\\\\\\":\\\\\\\"applicationType\\\\\\\",\\\\\\\"value\\\\\\\":\\\\\\\"Master_User\\\\\\\"},{\\\\\\\"key\\\\\\\":\\\\\\\"userName\\\\\\\",\\\\\\\"value\\\\\\\":\\\\\\\"pranitha@datagaps.com\\\\\\\"},{\\\\\\\"key\\\\\\\":\\\\\\\"password\\\\\\\",\\\\\\\"value\\\\\\\":\\\\\\\"U2FsdGVkX1/O5FOnNWWeRFtobK2b27ABHZz7gCdg+fU\\u003d\\\\\\\"},{\\\\\\\"key\\\\\\\":\\\\\\\"applicationId\\\\\\\",\\\\\\\"value\\\\\\\":\\\\\\\"721bab0f-2b2b-45db-aff2-4bb1deea5568\\\\\\\"}]}\\u0027\\u0027\\u0027)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":29,\"componentName\":\"Code 29\",\"tableName\":\"code_29\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"import time\\nfrom datagaps_utilities import config, db_functions\\nprint(config.log_file_path)\\nprint(config.DB_HOST)\\nprint(config.DB_NAME)\\nprint(config.DB_USER)\\nprint(config.DB_PASSWORD)\\nprint(config.DB_PORT)\\ndb_connection \\u003d db_functions.get_db_connection()\\ncursor \\u003d db_connection.cursor()\\n\\nquery_string \\u003d \\\"\\\"\\\"SELECT df_component_run_id, status, statement_name, output_json from t_df_comp_statements WHERE df_component_run_id \\u003d %s and statement_name \\u003d %s limit 10\\\"\\\"\\\"\\nfor j in range(10):\\n    cursor.execute(query_string, (33785, \\\"load_datasets\\\"))\\n    \\n    for i in cursor.fetchall():\\n        print(i)\\n    time.sleep(0.5)\\n\\n# query_string \\u003d \\\"\\\"\\\"UPDATE t_df_comp_statements SET output_json \\u003d %s,\\n#  status \\u003d %s WHERE df_component_run_id \\u003d %s and statement_name \\u003d %s\\\"\\\"\\\"\\n# cursor.execute(query_string, (\\\"\\\", \\u0027Not Executed\\u0027, 33739, \\\"load_datasets\\\"))\\n# db_connection.commit()\\n\\n\\n# query_string \\u003d \\\"\\\"\\\"SELECT df_component_run_id, status, statement_name, output_json from t_df_comp_statements WHERE df_component_run_id \\u003d %s and statement_name \\u003d %s limit 10\\\"\\\"\\\"\\n\\n# cursor.execute(query_string, (33739, \\\"load_datasets\\\"))\\n\\n# for i in cursor.fetchall():\\n#     print(i)\\n    \\n    \\n    \\nwith open(config.log_file_path) as f:\\n    print(f.read())\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":30,\"componentName\":\"Code 30\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"# from pyspark.sql.functions import max, length\\nfrom py4j.java_gateway import java_import\\nfrom datetime import datetime\\nimport json\\njava_import(spark._sc._jvm, \\\"org.apache.spark.sql.api.python.*\\\")\\n# create a sample dataframe\\ndata \\u003d [(\\\"John\\\", \\\"Doe\\\", 25, datetime.now()),\\n        (\\\"Jane\\\", \\\"Doe\\\", 30, datetime.now()),\\n        (\\\"Bob\\\", \\\"Smith\\\", 35, datetime.now())]\\ndf \\u003d spark.createDataFrame(data, [\\\"first_name\\\", \\\"last_name\\\", \\\"age\\\", \\\"date\\\"])\\ndf.show()\\n# calculate maximum length of data in each column\\nmax_lengths \\u003d df.agg(*[max(length(col)).alias(col) for col in df.columns])\\n\\n# show the maximum lengths\\nmax_lengths.show()\\n\\njd \\u003d max_lengths.toJSON().collect()\\njd \\u003d [json.loads(i) for i in jd]\\nprint(jd)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":31,\"componentName\":\"Code 31\",\"tableName\":\"code_31\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import config\\n\\nprint(config.root_folder)\\nprint(config.DB_HOST)\\nprint(config.DB_NAME)\\nprint(config.DB_USER)\\nprint(config.DB_PASSWORD)\\nprint(config.DB_PORT)\\n\\n\\nprint(config.browser_location)\\nprint(config.configs.get(\\\"browser_location\\\"))\\nprint(config.configs.get(\\\"abc\\\"))\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":32,\"componentName\":\"Code 32\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"from py4j.java_gateway import java_import\\njava_import(spark._sc._jvm, \\\"org.apache.spark.sql.api.python.*\\\")\\n\\nfrom tableauhyperapi import HyperProcess, Telemetry, Connection\\nimport pandas as pd\\nimport re\\n\\nwith HyperProcess(telemetry\\u003dTelemetry.SEND_USAGE_DATA_TO_TABLEAU,parameters\\u003d{\\u0027log_dir\\u0027:\\\"/tmp\\\"}) as hyper:\\n    with Connection(hyper.endpoint,\\\"/home/datagaps/superstore_sample_denormalized.hyper\\\") as connection:\\n        table_names \\u003d connection.catalog.get_table_names(schema\\u003d\\\"Extract\\\")\\n        for table_name in table_names:\\n            table_definition \\u003d connection.catalog.get_table_definition(table_name)\\n            table \\u003d connection.execute_query(f\\\"SELECT * FROM {table_name}\\\")\\n            print(table)\\n            df \\u003d pd.DataFrame(table, columns\\u003d[column.name for column in table_definition.columns])\\n            print(df.head())\\n            print(df.to_dict(orient\\u003d\\\"records\\\"))\\n\\n            sdf \\u003d spark.read.json(spark.sparkContext.parallelize(df.to_dict(orient\\u003d\\\"records\\\")).map(lambda x: json.dumps(x)))\\n            sdf \\u003d sdf.toDF(*[re.sub(\\u0027[^0-9A-Za-z_]\\u0027, \\u0027_\\u0027, c) for c in sdf.columns])\\n            sdf.show()\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":33,\"componentName\":\"Code 33\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":3,\"componentName\":\"SQL 3\",\"tableName\":\"SQL_3\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[1],\"options\":{\"dbTable\":\"select Count_of_DepartmentName,Sum_of_BaseRate,Sum_of_PayFrequency,Sum_of_Sick_Leave_Hours,Vacation_Hours from vis3\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"code\":\"from datagaps_utilities import dataset_flatten \\r\\n\\r\\n\\r\\ndataset_flatten(session_object\\u003dspark, input_dataset\\u003d\\\"File_6\\\", unique_columns\\u003d\\\"id\\\", output_dataset_1\\u003d\\\"out1\\\", output_dataset_2\\u003d\\\"out2\\\")\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n# dataset_flatten(spark, \\\"File_6\\\", \\\"class, class2\\\", \\\"out1\\\", \\\"out2\\\")\\r\\n\\r\\n# dataset_to_rdb(spark,\\\"File_6\\\",primary_table_name\\u003d\\\"datagaps\\\", use_short_names\\u003dFalse,component_name\\u003d\\\"Code 9\\\", dataflow_run_id\\u003d$[dataflow_run_id], dataflow_id\\u003d\\\"$[dataflow_id]\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":7,\"componentName\":\"Code 7\",\"tableName\":\"code_7\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[6],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"executionOption\":\"allparentpassorfail\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":8,\"componentName\":\"SQL 8\",\"tableName\":\"SQL_8\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[7],\"options\":{\"dbTable\":\"select * from out2\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"},{\"pluginId\":\"5533c9f0-415f-40df-ade0-47bb74faa9cf\",\"pluginName\":\"Write differences to a CSV file location upendar\",\"pluginOptions\":{\"parameters\":[{\"parameterId\":\"0251e01e-fc2c-4a36-ad68-ac544009098f\",\"fieldName\":\"CSV_DS_Name\",\"displayName\":\"Target CSV Data source name\",\"value\":\"CSV_shared_folder_upendar\",\"dataType\":\"String\"}],\"inputDatasets\":[{\"inputDatasetId\":\"f9fc428c-04bb-4c18-a802-610d2484d0e7\",\"fieldName\":\"dataset\",\"displayName\":\"Enter data compare dataset name\",\"value\":\"Data_Compare_21\"}],\"outputDatasets\":[],\"dataSources\":[]},\"componentId\":20,\"componentName\":\"Plugin 20\",\"tableName\":\"Plugin_20\",\"category\":\"Processor\",\"componentType\":\"Plugin\",\"rank\":0,\"displayRows\":0,\"dependencies\":[21],\"options\":{},\"className\":\"com.datagaps.dataflow.models.PluginComponent\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":26,\"componentName\":\"SQL 26\",\"tableName\":\"SQL_26\",\"category\":\"Processor\",\"componentType\":\"SQL\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[25],\"options\":{\"dbTable\":\"select * from vis13\"},\"className\":\"com.datagaps.dataflow.models.SQLComponent\",\"isCheckpointEnabled\":\"N\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":33,"livyOptions":"{\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":0,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":\"\",\"conf\":{},\"heartbeatTimeoutInSecond\":0,\"kind\":\"spark\"}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow/upendar","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}