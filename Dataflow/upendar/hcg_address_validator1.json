{"dataflow":{"dfKey":"0cc25f2b-e6d7-44dc-b616-691285ad153d","name":"hcg_address_validator1","tags":null,"description":null,"definition":"{\"name\":\"hcg_address_validator1\",\"version\":0,\"livyServerId\":0,\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"excludeNotification\":\"N\"},{\"partitionOptions\":{\"partitionType\":\"\",\"name\":\"\"},\"enableTrim\":\"N\",\"easyQueryDefJson\":{\"sqlQuery\":\"\"},\"componentId\":1,\"componentName\":\"JDBC 1\",\"tableName\":\"JDBC_1\",\"category\":\"Source\",\"componentType\":\"JDBC\",\"rank\":0,\"dataSourceName\":\"Salesforce_smt\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"dbTable\":\"select id__c,name__c,addressLines__c,locality__c,administrativeArea__c,postalCode__c,regionCode__c from hcg_usecase__c\"},\"className\":\"com.datagaps.dataflow.models.JDBCComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"import os\\nimport requests\\nimport json\\n\\ndf\\u003dspark.sql(\\\"select addressLines,locality,administrativeArea,postalCode,regionCode from File_2\\\")\\n#pdf \\u003d df.toPandas().to_dict(orient\\u003d\\\"records\\\")\\nprint(pdf)\\n\\nurl \\u003d \\\"https://addressvalidation.googleapis.com/v1:validateAddress?key\\u003dAIzaSyB0x7D_gq87Z60lzpPfzOpJP3EnqHFs4Ug\\\"\\n\\npayload \\u003d json.dumps({\\n  \\\"address\\\": {\\n    \\\"regionCode\\\": \\\"US\\\",\\n    \\\"locality\\\": \\\"Mountain\\\",\\n    \\\"administrativeArea\\\": \\\"CA\\\",\\n    \\\"postalCode\\\": \\\"94043\\\",\\n    \\\"addressLines\\\": [\\n      \\\"1600 Amphitheatre Pkwy\\\"\\n    ]\\n  }\\n})\\n\\n\\nresponse \\u003d requests.request(\\\"POST\\\", url, headers\\u003dheaders, data\\u003dpayload)\\n\\nprint(response.json()[\\\"result\\\"][\\\"address\\\"][\\\"postalAddress\\\"])\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":3,\"componentName\":\"Code 3\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"},{\"code\":\"import os\\nimport requests\\nimport json\\n\\ndf\\u003dspark.sql(\\\"select addressLines,locality,administrativeArea,postalCode,regionCode from File_2\\\")\\npdf \\u003d df.toPandas()[0:1].to_dict(orient\\u003d\\\"records\\\")\\nprint(pdf)\\n\\n\\n# def api_call(x):\\n#     params\\u003dtuple(x.items())\\n#     url \\u003d \\\"https://addressvalidation.googleapis.com/v1:validateAddress?key\\u003dAIzaSyB0x7D_gq87Z60lzpPfzOpJP3EnqHFs4Ug\\\"\\n#     headers \\u003d {\\u0027Content-Type\\u0027: \\u0027application/json\\u0027}\\n#     payload\\u003djson.dumps(x)\\n#     response \\u003d requests.post(url,headers\\u003dheaders,data\\u003dpayload)\\n#     output_json\\u003dresponse.json()#[\\\"result\\\"][\\\"address\\\"][\\\"postalAddress\\\"]\\n#     #print(output_json)\\n#     response_time\\u003dresponse.elapsed.total_seconds()\\n#     response_code\\u003dresponse.status_code\\n#     return {**x,\\\"response_time\\\":response_time,\\\"output_json\\\":output_json,\\\"response_code\\\":response_code}\\n\\n# l\\u003d[]\\n# for i in pdf:\\n#     l.append(api_call(i))\\n\\n# ll\\u003djson.dumps(l)    \\n# df2\\u003dspark.read.json(sc.parallelize([ll]))#.repartition(1).withColumn(\\u0027index\\u0027, F.monotonically_increasing_id()+1)\\n# df2.show()\\n# df2.createOrReplaceTempView(\\\"ar1\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":6,\"componentName\":\"Code 6\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"}]","version":3,"maxComponentId":7,"livyOptions":"{\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":0,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":null,\"conf\":{},\"heartbeatTimeoutInSecond\":0,\"kind\":\"spark\"}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow/upendar","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}