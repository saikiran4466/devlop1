{"dataflow":{"dfKey":"a0787d3e-7dc4-4346-b150-3ac83bc20c95","name":"FixedWidth_upendar","tags":null,"description":"Â ","definition":"{\"name\":\"FixedWidth_upendar\",\"description\":\"Â \",\"version\":0,\"livyServerId\":0,\"engineVariableName\":\"\",\"components\":[{\"udfNames\":[],\"componentId\":0,\"componentName\":\"startComponent\",\"tableName\":\"\",\"category\":\"Start\",\"componentType\":\"UDF\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":0,\"dependencies\":[],\"className\":\"com.datagaps.dataflow.models.UDFComponent\",\"excludeNotification\":\"N\"},{\"code\":\"import pandas as pd\\r\\nimport csv\\r\\nimport smbclient\\r\\nimport os\\r\\nsmbclient.ClientConfig(username\\u003d\\\"$[user]\\\", password\\u003d\\\"$[pwd]\\\")\\r\\ns\\u003d\\u0027\\u0027\\r\\nwith smbclient.open_file(\\u0027$[SRC_FILE]\\u0027,mode\\u003d\\\"r\\\") as fd:\\r\\n    s \\u003d fd.read()\\r\\n    o \\u003d []\\r\\n    while s:\\r\\n        o.append(s[:$[ROW_WIDTH]])\\r\\n        s \\u003d s[$[ROW_WIDTH]:]\\r\\n    df \\u003d pd.DataFrame(o)\\r\\nwith smbclient.open_file(r\\u0027$[TGT_FILE]\\u0027,mode\\u003d\\\"w\\\") as fd1:\\r\\n    df.to_csv(fd1, index\\u003dFalse, header\\u003dFalse)\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":3,\"componentName\":\"ConvertRowFixedWidthFile\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"},{\"format\":\"txt\",\"enableSchema\":\"N\",\"schema\":[],\"fileMetadata\":[],\"enableTrim\":\"N\",\"componentId\":4,\"componentName\":\"File 4\",\"tableName\":\"File_4\",\"category\":\"Source\",\"componentType\":\"File\",\"rank\":0,\"dataSourceName\":\"Fixed LengthS3_ukcp\",\"displayRows\":50,\"dependencies\":[],\"options\":{\"path\":\"FixedWidthFile.txt\",\"usePasswordVault\":\"n\",\"inferSchema\":\"true\"},\"className\":\"com.datagaps.dataflow.models.FileComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"excludeNotification\":\"N\"},{\"code\":\"import pyodbc\\nprint(\\\"hai\\\")\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":5,\"componentName\":\"Code 5\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"},{\"code\":\"import math\\r\\nimport time\\r\\nimport smbclient\\r\\nimport pandas as pd\\r\\n\\r\\nt1 \\u003d time.time()\\r\\nsmbclient.ClientConfig(username\\u003d\\\"$[user]\\\", password\\u003d\\\"$[pwd]\\\")\\r\\nfixed_width \\u003d $[ROW_WIDTH]\\r\\nstart_position \\u003d 0\\r\\ncolumn_name \\u003d None\\r\\n\\r\\n\\r\\nwith smbclient.open_file(r\\\"$[SRC_FILE]\\\", mode\\u003d\\\"r\\\") as fd:\\r\\n    s \\u003d fd.read()\\r\\nprint(\\\"time to read file from shared folder\\\", time.time() - t1)\\r\\nt2 \\u003d time.time()\\r\\nres \\u003d []\\r\\nfor _ in range(math.ceil(len(s)/fixed_width)):\\r\\n    res.append(s[start_position:fixed_width + start_position])\\r\\n    start_position +\\u003d fixed_width\\r\\nprint(\\\"time for loop\\\", time.time() - t2)\\r\\n\\r\\nt2 \\u003d time.time()\\r\\nif column_name:\\r\\n    df \\u003d pd.DataFrame(res, columns\\u003d[column_name])\\r\\nelse:\\r\\n    df \\u003d pd.DataFrame(res)\\r\\n\\r\\n\\r\\nwith smbclient.open_file(r\\u0027$[TGT_FILE]\\u0027,mode\\u003d\\\"w\\\") as fd1:\\r\\n    if column_name:\\r\\n        df.to_csv(fd1, index\\u003dFalse)\\r\\n    else:\\r\\n        df.to_csv(fd1, index\\u003dFalse, header\\u003dFalse)\\r\\n\\r\\nprint(\\\"time for save file\\\", time.time() - t2)\\r\\n\\r\\nprint(\\\"total time\\\", time.time() - t1)\\r\\n\",\"kind\":\"pyspark\",\"dataSourceId\":0,\"componentId\":7,\"componentName\":\"Code 7\",\"tableName\":\"\",\"category\":\"Processor\",\"componentType\":\"Code\",\"rank\":0,\"dataSourceName\":\"\",\"displayRows\":50,\"dependencies\":[],\"options\":{},\"className\":\"com.datagaps.dataflow.models.CodeComponent\",\"excludeNotification\":\"N\"},{\"format\":\"txt\",\"enableSchema\":\"N\",\"schema\":[],\"fileMetadata\":[{\"columnName\":\"hello\",\"startPosition\":1,\"length\":12}],\"enableTrim\":\"N\",\"componentId\":6,\"componentName\":\"File 6\",\"tableName\":\"File_6\",\"category\":\"Source\",\"componentType\":\"File\",\"rank\":0,\"dataSourceName\":\"Fixed Length_shared_ukcp\",\"displayRows\":50,\"dependencies\":[5],\"options\":{\"inferSchema\":\"true\",\"path\":\"Fixedwidth_Client.txt\"},\"className\":\"com.datagaps.dataflow.models.FileComponent\",\"isCheckpointEnabled\":\"N\",\"dataSourceLogicalName\":\"\",\"excludeNotification\":\"N\"}],\"isDeleteWorkSchemaTable\":\"N\"}","parameters":"[{\"name\":\"limit_rows\",\"defValueInInteractiveMode\":\"limit 10\",\"defValueInBatchMode\":\"limit 1000\"},{\"name\":\"ROW_WIDTH\",\"defValueInInteractiveMode\":\"52\",\"defValueInBatchMode\":\"52\"},{\"name\":\"SRC_FILE\",\"defValueInInteractiveMode\":\"\\\\\\\\192.168.6.51\\\\store\\\\upendar\\\\test_file_narayana_16.txt\",\"defValueInBatchMode\":\"\\\\\\\\192.168.6.51\\\\store\\\\upendar\\\\test_file_narayana_16.txt\"},{\"name\":\"TGT_FILE\",\"defValueInInteractiveMode\":\"\\\\\\\\192.168.6.51\\\\store\\\\upendar\\\\test_file_narayana_16_upendar.csv\",\"defValueInBatchMode\":\"\\\\\\\\192.168.6.51\\\\store\\\\upendar\\\\test_file_narayana_16_upendar.csv\"},{\"name\":\"user\",\"defValueInInteractiveMode\":\"upendar.pinni@datagapsinc.in\",\"defValueInBatchMode\":\"upendar.pinni@datagapsinc.in\"},{\"name\":\"pwd\",\"defValueInInteractiveMode\":\"7TzkFK9yUz\",\"defValueInBatchMode\":\"7TzkFK9yUz\"}]","version":3,"maxComponentId":7,"livyOptions":"{\"proxyUser\":\"\",\"jars\":[],\"pyFiles\":[],\"files\":[],\"driverMemory\":\"\",\"driverCores\":0,\"executorMemory\":\"\",\"executorCores\":0,\"numExecutors\":0,\"archives\":[],\"queue\":\"\",\"name\":\"\",\"conf\":{},\"heartbeatTimeoutInSecond\":0,\"kind\":\"spark\"}","isDeleted":"N","userName":null,"type":"dataflow","environmentName":"","folderPath":"Dataflow/upendar","workSchemaName":null},"analysis":[],"datamodels":[],"tagDetails":[],"dataCompares":[]}